[
  {
    "objectID": "results/overall_health.html",
    "href": "results/overall_health.html",
    "title": "Overall Health - Statistical Modeling",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(readr)\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\n\n# Filter out rows with missing values in critical columns\ndf &lt;- df %&gt;% \n  filter(!is.na(overall_health_ranking) & \n         !is.na(coverage_access_and_affordability) &\n         !is.na(health_care_quality_and_prevention) &\n         !is.na(health_outcomes) &\n         !is.na(medicaid_expansion_status) &\n         !is.na(state_requires_coverage_of_prescription_contraception) \n         )\n\n#head(df)"
  },
  {
    "objectID": "results/overall_health.html#overall-health",
    "href": "results/overall_health.html#overall-health",
    "title": "Overall Health - Statistical Modeling",
    "section": "Overall Health",
    "text": "Overall Health\n\nOverall Health Ranking by Abortion Policy\n\n\nCode\n# Reorder the levels of abortion policies\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                               levels = c(\"most protective\", \"very protective\", \n                                          \"protective\", \"some restrictions/protections\", \n                                          \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\n# Bin overall_health_ranking into categories\ndf$overall_health_category &lt;- cut(df$overall_health_ranking,\n                                  breaks = c(-Inf, 10, 20, 30, 40, 50, Inf),\n                                  labels = c(\"most healthy\", \"very healthy\", \n                                             \"healthy\", \"average\", \n                                             \"below average\", \"unhealthy\"))\n\n# Stacked bar plot by abortion policy\nggplot(df, aes(x = abortion_policies, fill = overall_health_category)) +\n  geom_bar(position = \"fill\") +\n  labs(\n    x = \"Abortion Policy\", \n    y = \"Proportion\", \n    fill = \"Overall Health Category\",\n    title = \"Proportion of Overall Health Categories by Abortion Policy\"\n  ) +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\")) + \n  theme_classic() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(size = 12, hjust = 0.5)\n  )\n\n\n\n\n\n\n\n\n\nThis plot reveals that states with “most protective” abortion policies tend to have the highest proportions of “most healthy” and “very healthy” health outcomes. In contrast, as policies become more restrictive, there is an apparent increase in the proportion of states categorized as “unhealthy” or “below average.” This suggests that states with restrictive abortion policies are not only limiting access to reproductive healthcare but may also be falling behind in fostering broader public health outcomes. These restrictive states disproportionately represent environments where overall health conditions are poorer, potentially reflecting a lack of investment in comprehensive healthcare systems or preventative care infrastructure.\nAlternatively, states with protective abortion policies appear to align with stronger public health systems, where access to care and preventative measures may contribute to better overall health rankings. This pattern underscores a broader connection between policy decisions prioritizing individual health rights and the overall well-being of a population.\n\n\nCode\n# Kruskal-Wallis Test: captures difference in overall_healths numeric rankings\n\nkruskal_test &lt;- kruskal.test(overall_health_ranking ~ abortion_policies, data = df)\nprint(kruskal_test)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  overall_health_ranking by abortion_policies\nKruskal-Wallis chi-squared = 23.649, df = 6, p-value = 0.0006058\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests \npairwise.wilcox.test(df$overall_health_ranking,\n                     df$abortion_policies, p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$overall_health_ranking and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.0000          -               -         \nprotective                    1.0000          1.0000          -         \nsome restrictions/protections 1.0000          1.0000          1.0000    \nrestrictive                   1.0000          1.0000          1.0000    \nvery restrictive              1.0000          0.8909          0.5035    \nmost restrictive              0.6165          0.0946          0.0034    \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.0000                        -          \nvery restrictive              1.0000                        1.0000     \nmost restrictive              1.0000                        0.4437     \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.0000          \n\nP value adjustment method: bonferroni \n\n\nThe Kruskal-Wallis Test (χ² = 23.649, df = 6, p = 0.0006058) reveals statistically significant differences in the numeric overall health rankings across the seven levels of abortion policy restrictiveness. This suggests that abortion policy restrictiveness correlates with variations in health outcomes. The low p-value (&lt; 0.05) indicates that these differences are unlikely to have occurred by chance. This result supports the observation from the stacked bar plot: more restrictive abortion policies tend to align with poorer health outcomes, while more protective policies are associated with better health outcomes.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'clinfun' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpOSnbk6\\downloaded_packages\n\n\nCode\nlibrary(clinfun)\n\n\nWarning: package 'clinfun' was built under R version 4.4.2\n\n\nCode\n# First, check sample sizes in each group\ntable(df$abortion_policies)\n\n\n\n              most protective               very protective \n                            2                             7 \n                   protective some restrictions/protections \n                           10                             5 \n                  restrictive              very restrictive \n                            7                             4 \n             most restrictive \n                           16 \n\n\nCode\n# Run Jonckheere-Terpstra test\njt_test &lt;- jonckheere.test(df$overall_health_ranking, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 806.5, p-value = 1e-04\nalternative hypothesis: increasing\n\n\nNow we will perform linear regression to investigate the direction of this relationship. Before doing so, we must check assumptions:\n\n\nCode\n# Assumptions: \nlibrary(lmtest)\n\n\nWarning: package 'lmtest' was built under R version 4.4.2\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nCode\nprocessed_data &lt;- df %&gt;%\n  group_by(abortion_policies) %&gt;%\n  summarise(avg_ranking = mean(overall_health_ranking, na.rm = TRUE))\n\n# 1. Linearity \nggplot(processed_data, aes(x = factor(abortion_policies), y = avg_ranking)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Linearity Check\")\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nCode\n# 2. Independence \nlm_model &lt;- lm(avg_ranking ~ as.numeric(abortion_policies), data = processed_data)\ndwtest(lm_model)\n\n\n\n    Durbin-Watson test\n\ndata:  lm_model\nDW = 2.7919, p-value = 0.7472\nalternative hypothesis: true autocorrelation is greater than 0\n\n\nCode\n# 3. Homoscedasticity\nplot(lm_model, which = 1)  # plots the residuals vs fitted  \n\n\n\n\n\n\n\n\n\nCode\nbptest(lm_model) # heteroscedasticity test-- p-val &lt; 0.05 indicates clear violation of homoscedasticity \n\n\n\n    studentized Breusch-Pagan test\n\ndata:  lm_model\nBP = 1.3513, df = 1, p-value = 0.245\n\n\nCode\n#2. Normality of residuals \nplot(lm_model, which = 2)  # qq plot\n\n\n\n\n\n\n\n\n\nCode\nhist(resid(lm_model), main = \"Histogram of Residuals\", xlab = \"Residuals\")\n\n\n\n\n\n\n\n\n\nNone of the assumptions for linear regression appear to be significantly violated, based on these tests. Since the heteroscedasticity test yields. p-value of 0.245, there is no significant evidence to suggest this data violates the homoscedasticity assumption. The qq-plot and histogram indicate that the data is, for the most part, approximately Normal, but the small sample size is likely the main factor impacting the strange shape of the histogram. Nevertheless, we assume that none of these slight deviations are extreme enough to violate the assumption, so we can continue with our linear regression:\nNull hypothesis: the mean overall health ranking is the same in each level of abortion policy.\nAlternative hypothesis: at least one abortion policy group has a significantly different effect on the mean overall health ranking.\n\n\nCode\n# Linear Regression\nprocessed_data &lt;- df %&gt;%\n  group_by(abortion_policies) %&gt;%\n  summarise(avg_ranking = mean(overall_health_ranking, na.rm = TRUE))\n\n# Fit linear model to calculate R-squared\nlm_model &lt;- lm(avg_ranking ~ as.numeric(abortion_policies), data = processed_data)\nr_squared &lt;- round(summary(lm_model)$r.squared, 3)\n\n# Plot with R-squared annotation\nggplot(processed_data, aes(x = abortion_policies, y = avg_ranking)) +\n  geom_point(size = 4, color = \"blue\") +\n  geom_smooth(aes(group = 1), method = \"lm\", se = TRUE, color = \"red\") +\n  labs(title = \"Overall Health Ranking\",\n       x = \"Abortion Policy\",\n       y = \"Ranking\") +\n  annotate(\"text\", \n           x = length(levels(processed_data$abortion_policies)) - 0.5, \n           y = max(processed_data$avg_ranking), \n           label = paste0(\"R² = \", r_squared),\n           size = 5, \n           color = \"black\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1), \n        plot.title = element_text(hjust = 0.5, size = 14))\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWith a p-value of 0.0006981, this linear regression model provides significant evidence to reject the null hypothesis in favor of the alternative and suggest that at least one level of abortion policy has a significant inclufence on the overall health ranking. This linear regression plot shows a strong, positive relationship between abortion policy restrictiveness and overall health ranking. As abortion policies become more restrictive (moving from “most protective” to “most restrictive”), the overall health ranking worsens (increases numerically). The R² value of 0.917 indicates that 91.7% of the variation in overall health ranking is explained by the level of restrictiveness in abortion policies. This suggests a clear and significant trend where stricter abortion policies are associated with poorer overall health outcomes.\nMISSING PERMUTATION TEST\n\n\nMedicaid Expansion Status by Abortion Policy\n\n\nCode\ndf$medicaid_expansion &lt;- factor(df$medicaid_expansion_status, levels = c(\"0\", \"1\"))\n\n# Stacked bar plot of Medicaid Expansion Status with Abortion Policies as Fill\nggplot(df, aes(x = medicaid_expansion, fill = abortion_policies)) +\n  geom_bar(position = \"fill\") +\n  labs(\n    x = \"Medicaid Expansion Status\", \n    y = \"Proportion\", \n    fill = \"Abortion Policy\",\n    title = \"Proportion of Abortion Policies by Medicaid Expansion Status\"\n  ) +\n  scale_x_discrete(labels = c(\"0\" = \"Not Expanded\", \"1\" = \"Expanded\")) +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  theme_classic() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(size = 12, hjust = 0.5)\n  )\n\n\n\n\n\n\n\n\n\nThis plot highlights how states that have not expanded Medicaid are disproportionately associated with more restrictive abortion policies. In contrast, states that have expanded Medicaid show a higher proportion of protective and less restrictive abortion policies. This pattern suggests a potential relationship between policy choices around healthcare access (Medicaid expansion) and reproductive rights (abortion policies), where more progressive health policies align with broader healthcare access.\n\n\nCode\n# Fisher's Exact Test\ncontingency_table &lt;- table(df$medicaid_expansion_status, df$abortion_policies)\n\nfisher_test_result &lt;- fisher.test(contingency_table)\nprint(fisher_test_result)\n\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 0.03091\nalternative hypothesis: two.sided\n\n\nThe Fisher’s Exact Test yielded a p-value of 0.03091, indicating a statistically significant association between Medicaid expansion status and abortion policies. This suggests that the distribution of Medicaid expansion (expanded vs. not expanded) varies significantly across different abortion policy categories. States’ decisions on Medicaid expansion may align with their stance on abortion policies.\nNow we will perform logistic regression to investigate the direction of this relationship, since our dependent variable is a binary categorical variable:\n\n\nCode\n# Check assumptions for logistic regression \ntable(df$medicaid_expansion_status, df$abortion_policies)\n\n\n   \n    most protective very protective protective some restrictions/protections\n  0               0               0          0                             0\n  1               2               7         10                             5\n   \n    restrictive very restrictive most restrictive\n  0           3                1                7\n  1           4                3                9\n\n\nSample sizes for logistic regression are too small, so we must use exact logistic regression to account for this size and separation:\n\n\nCode\nlibrary(logistf)\n\n# Fit the exact logistic regression model\nfit &lt;- logistf(medicaid_expansion_status ~ factor(abortion_policies), data = df)\n\nsummary(fit)\n\n\nlogistf(formula = medicaid_expansion_status ~ factor(abortion_policies), \n    data = df)\n\nModel fitted by Penalized ML\nCoefficients:\n                                                             coef se(coef)\n(Intercept)                                             1.6094379 1.549193\nfactor(abortion_policies)very protective                1.0986123 2.129163\nfactor(abortion_policies)protective                     1.4350845 2.120198\nfactor(abortion_policies)some restrictions/protections  0.7884574 2.140518\nfactor(abortion_policies)restrictive                   -1.3581235 1.705267\nfactor(abortion_policies)very restrictive              -0.7621401 1.830951\nfactor(abortion_policies)most restrictive              -1.3730491 1.624376\n                                                       lower 0.95 upper 0.95\n(Intercept)                                            -0.8993577   6.536132\nfactor(abortion_policies)very protective               -4.2449368   6.453876\nfactor(abortion_policies)protective                    -3.8986862   6.781282\nfactor(abortion_policies)some restrictions/protections -4.5677245   6.155104\nfactor(abortion_policies)restrictive                   -6.4096451   1.555766\nfactor(abortion_policies)very restrictive              -5.9125654   2.600042\nfactor(abortion_policies)most restrictive              -6.3586197   1.327338\n                                                           Chisq         p\n(Intercept)                                            1.4555158 0.2276449\nfactor(abortion_policies)very protective               0.2579603 0.6115249\nfactor(abortion_policies)protective                    0.4335919 0.5102317\nfactor(abortion_policies)some restrictions/protections 0.1335787 0.7147500\nfactor(abortion_policies)restrictive                   0.7522045 0.3857792\nfactor(abortion_policies)very restrictive              0.1853520 0.6668136\nfactor(abortion_policies)most restrictive              0.8859352 0.3465812\n                                                       method\n(Intercept)                                                 2\nfactor(abortion_policies)very protective                    2\nfactor(abortion_policies)protective                         2\nfactor(abortion_policies)some restrictions/protections      2\nfactor(abortion_policies)restrictive                        2\nfactor(abortion_policies)very restrictive                   2\nfactor(abortion_policies)most restrictive                   2\n\nMethod: 1-Wald, 2-Profile penalized log-likelihood, 3-None\n\nLikelihood ratio test=10.87201 on 6 df, p=0.09241346, n=51\nWald test = 12.68851 on 6 df, p = 0.04825799\n\n\n\n\nCode\n# Generate predicted probabilities\ndf$predicted_prob &lt;- predict(fit, type = \"response\")\n\n# visualize\nggplot(df, aes(x = abortion_policies, y = predicted_prob)) +\n  geom_point(position = position_jitter(width = 0.2), alpha = 0.6) +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  labs(x = \"Abortion Policies\", \n       y = \"Predicted Probability\",\n       title = \"Medicaid Expansion Status \\nPredicted Probabilities by Abortion Policy\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        plot.title = element_text(hjust = 0.5, size = 14))\n\n\n\n\n\n\n\n\n\nThe exact logistic regression model yields a p-value of 0.0483 from the Wald test, indicating that abortion policies are significantly associated with Medicaid expansion status. The slope coefficients suggest that as abortion policies become more restrictive, the predicted probability of Medicaid expansion decreases. The visualization reinforces this relationship, showing higher predicted probabilities of Medicaid expansion among states with protective abortion policies and sharply lower probabilities in states with restrictive abortion policies. This pattern highlights a critical divide in policy decisions: states prioritizing broader reproductive rights are also more likely to expand healthcare access through Medicaid, whereas restrictive abortion policies align with reduced Medicaid expansion. This underscores the broader policy implications of prioritizing access to healthcare and reproductive rights.\n\n\nCoverage, Access, and Affordability by Abortion Policy\n\n\nCode\n# Boxplot for coverage and abortion policies\nggplot(df, aes(x = abortion_policies, y = coverage_access_and_affordability, fill = abortion_policies)) +\n  geom_boxplot() +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(\n    x = \"Abortion Policies\", \n    y = \"Coverage Access and Affordability\", \n    fill = \"Abortion Policies\",\n    title = \"Coverage Access and Affordability by Abortion Policies\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(size = 12, hjust = 0.5)\n  )\n\n\n\n\n\n\n\n\n\nStates with “most protective” abortion policies tend to have better rankings (lower values), indicating higher coverage access and affordability. Conversely, states with more restrictive abortion policies exhibit worse rankings (higher values), suggesting reduced coverage access and affordability. This trend may reflect that states with protective abortion policies prioritize healthcare equity and access more effectively than those with restrictive policies.\nThis disparity also highlights inconsistencies in the priorities of restrictive states. States with protective abortion policies might integrate reproductive healthcare into broader healthcare initiatives, fostering better access and affordability. In contrast, restrictive states, which often frame their policies as being “pro-life,” may focus on generalized or inconsistent healthcare frameworks, leading to poorer outcomes. The lack of affordable and accessible healthcare in these states undermines their claims to protect life, as they fail to support the broader well-being of the populations they govern. These findings underscore both the interconnectedness between reproductive healthcare policy and overall healthcare accessibility and affordability, and the disconnect in restrictive states between policy rhetoric and actionable support for healthier communities.\n\n\nCode\nkruskal_test &lt;- kruskal.test(coverage_access_and_affordability ~ abortion_policies, data = df)\nprint(kruskal_test)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  coverage_access_and_affordability by abortion_policies\nKruskal-Wallis chi-squared = 22.583, df = 6, p-value = 0.0009489\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests \npairwise.wilcox.test(df$coverage_access_and_affordability,\n                     df$abortion_policies, p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$coverage_access_and_affordability and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            0.46      \nvery restrictive              1.00            0.25            0.12      \nmost restrictive              0.27            0.12            0.03      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nThe Kruskal-Wallis test yielded a chi-squared value of 22.583 with 6 degrees of freedom and a p of 0.0009489. This statistically significant result indicates that there are differences in coverage access and affordability rankings among the seven abortion policy levels. States with more restrictive abortion policies appear to have higher (worse) rankings for coverage access and affordability compared to states with more protective policies, reinforcing the association between policy restrictiveness and reduced access to affordable care.\n\n\nCode\n# Run Jonckheere-Terpstra test\n\njt_test &lt;- jonckheere.test(df$coverage_access_and_affordability, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 763.5, p-value = 1e-04\nalternative hypothesis: increasing\n\n\n\n\nCode\n# Permutation Test Implementation for Coverage Access and Affordability\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(coverage_access_and_affordability ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$coverage_access_and_affordability &lt;- sample(permuted_data$coverage_access_and_affordability)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(coverage_access_and_affordability ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 6.089754 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 1e-04 \n\n\n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nA permutation test was performed on this data in addition to the Kruskal-Wallis test to ensure the robustness of the findings across different methods. The observed F-statistic of 6.089754 (indicated by the red dashed line) lies far to the right of the permutation distribution, representing F-statistics generated under the null hypothesis. The permutation test produced a statistically significant p-value of 1x10^-4, providing strong evidence that the observed differences in coverage access and affordability across abortion policy levels are unlikely to be due to random chance. This result supports the conclusion that coverage access and affordability rankings vary significantly by abortion policy level.\n\n\nPrescription Contraception Coverage Requirements by Abortion Policy\n\n\nCode\ndf$requires_prescription &lt;- factor(df$state_requires_coverage_of_prescription_contraception, levels = c(\"0\", \"1\"))\n\n# Stacked bar plot for Prescription Contraception Coverage Requirements\nggplot(df, aes(x = requires_prescription, fill = abortion_policies)) +\n  geom_bar(position = \"fill\") +\n  labs(x = \"Requires Prescription Coverage\", \n       y = \"Proportion\", \n       fill = \"Abortion Policy\",\n       title = \"Prescription Contraception Coverage Requirements by Abortion Policy\") +\n  scale_x_discrete(labels = c(\"0\" = \"Does Not Require\", \"1\" = \"Requires\")) +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) + \n  theme_classic() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        plot.title = element_text(hjust = 0, size = 12)) \n\n\n\n\n\n\n\n\n\nThe stacked bar plot demonstrates that states that do not require prescription coverage are predominantly associated with more restrictive abortion policies, whereas states that require prescription coverage tend to align with more protective abortion policies.\nThis pattern reveals a significant gap in healthcare priorities among restrictive abortion policy states. By failing to require prescription coverage, particularly for contraceptives, these states not only limit access to essential tools for preventing unintended pregnancies, effectively undermining efforts to reduce the need for abortions in the first place, but also neglect the broader healthcare needs of individuals. Contraceptives are often prescribed to manage health conditions such as dysmenorrhea, endometriosis, or hormonal regulation, which can significantly impact quality of life. States with protective abortion policies, which typically require prescription coverage, demonstrate a more holistic approach to healthcare, supporting both reproductive autonomy and broader health outcomes.\n\n\nCode\ncontingency_table &lt;- table(df$state_requires_coverage_of_prescription_contraception, df$abortion_policies)\nfisher_test_result &lt;- fisher.test(contingency_table)\nprint(fisher_test_result)\n\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 0.01764\nalternative hypothesis: two.sided\n\n\nThe Fisher’s Exact Test results yield a p-value of 0.01764, indicating a statistically significant association between whether a state requires prescription coverage and its abortion policy. This suggests that the distribution of states requiring or not requiring prescription coverage is not independent of their abortion policy levels. The association highlights how policy decisions in these states may systematically limit or increase access to reproductive healthcare and broader health support systems, reinforcing disparities in healthcare infrastructure and prioritization.\nNow, we will perform logistic regression to investigate the direction of this relationship:\n\n\nCode\n# Check assumptions for logistic regression \ntable(df$state_requires_coverage_of_prescription_contraception, df$abortion_policies)\n\n\n   \n    most protective very protective protective some restrictions/protections\n  0               0               1          1                             1\n  1               2               6          9                             4\n   \n    restrictive very restrictive most restrictive\n  0           4                2               11\n  1           3                2                5\n\n\nSample sizes for logistic regression are too small, so we must use exact logistic regression to account for this size and separation…\n\n\nCode\n# Logistic Regression\nlibrary(logistf)\n\n# Fit logistic regression model\nfit &lt;- logistf(state_requires_coverage_of_prescription_contraception ~ factor(abortion_policies), data = df)\n\n# View results\nsummary(fit)\n\n\nlogistf(formula = state_requires_coverage_of_prescription_contraception ~ \n    factor(abortion_policies), data = df)\n\nModel fitted by Penalized ML\nCoefficients:\n                                                             coef se(coef)\n(Intercept)                                             1.6094379 1.549193\nfactor(abortion_policies)very protective               -0.1431008 1.794579\nfactor(abortion_policies)protective                     0.2363888 1.780990\nfactor(abortion_policies)some restrictions/protections -0.5108256 1.813529\nfactor(abortion_policies)restrictive                   -1.8607523 1.705267\nfactor(abortion_policies)very restrictive              -1.6094379 1.788854\nfactor(abortion_policies)most restrictive              -2.3470369 1.633638\n                                                       lower 0.95 upper 0.95\n(Intercept)                                            -0.8993577  6.5361319\nfactor(abortion_policies)very protective               -5.2583237  3.1558062\nfactor(abortion_policies)protective                    -4.8662731  3.5104202\nfactor(abortion_policies)some restrictions/protections -5.6440931  2.8216151\nfactor(abortion_policies)restrictive                   -6.9149344  1.0302498\nfactor(abortion_policies)very restrictive              -6.7355228  1.5101927\nfactor(abortion_policies)most restrictive              -7.3414344  0.3645081\n                                                             Chisq          p\n(Intercept)                                            1.455515830 0.22764495\nfactor(abortion_policies)very protective               0.006456591 0.93595657\nfactor(abortion_policies)protective                    0.017133155 0.89585942\nfactor(abortion_policies)some restrictions/protections 0.083322594 0.77284423\nfactor(abortion_policies)restrictive                   1.489808677 0.22224615\nfactor(abortion_policies)very restrictive              0.950172752 0.32967533\nfactor(abortion_policies)most restrictive              2.814056557 0.09344182\n                                                       method\n(Intercept)                                                 2\nfactor(abortion_policies)very protective                    2\nfactor(abortion_policies)protective                         2\nfactor(abortion_policies)some restrictions/protections      2\nfactor(abortion_policies)restrictive                        2\nfactor(abortion_policies)very restrictive                   2\nfactor(abortion_policies)most restrictive                   2\n\nMethod: 1-Wald, 2-Profile penalized log-likelihood, 3-None\n\nLikelihood ratio test=13.07125 on 6 df, p=0.04191838, n=51\nWald test = 11.61987 on 6 df, p = 0.07100654\n\n\n\n\nCode\n# Generate predicted probabilities\ndf$predicted_prob &lt;- predict(fit, type = \"response\")\n\n# Visualize predicted probabilities\nggplot(df, aes(x = abortion_policies, y = predicted_prob)) +\n  geom_point(position = position_jitter(width = 0.2), alpha = 0.6) +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  labs(x = \"Abortion Policies\",\n       y = \"Predicted Probability\",\n       title = \"Predicted Probability of Prescription Contraceptive Coverage \\nby Abortion Policy\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        plot.title = element_text(hjust = 0.5, size = 14))\n\n\n\n\n\n\n\n\n\nThe exact logistic regression analysis provides evidence of a significant relationship between abortion policy restrictiveness and the likelihood of requiring prescription contraceptive coverage, as shown by the likelihood ratio test (p=0.0419). The predicted probabilities visualized here demonstrate a clear gradient: states with more restrictive abortion policies consistently exhibit lower probabilities of requiring prescription contraceptive coverage compared to those with more protective policies.\nThis trend highlights a potential disconnect in restrictive states, which often emphasize policies purportedly in favor of life but fail to mandate coverage for contraceptives that could prevent unintended pregnancies or support broader healthcare needs. On the other hand, states with protective abortion policies are more likely to require coverage, aligning with healthcare frameworks that prioritize both reproductive autonomy and overall well-being. These findings underscore how policy decisions around abortion can reflect broader approaches—or lack thereof—toward supporting individuals’ health and autonomy.\n\n\nHealthcare Quality and Prevention by Abortion Policy\n\n\nCode\nggplot(df, aes(x = abortion_policies, y = health_care_quality_and_prevention, fill = abortion_policies)) +\n  geom_boxplot() +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(\n    title = \"Health Care Quality and Prevention by Abortion Policies\",\n    x = \"Abortion Policies\",\n    y = \"Health Care Quality and Prevention\",\n    fill = \"Abortion Policies\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 12),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"right\"\n  )\n\n\n\n\n\n\n\n\n\nStates with “most protective” abortion policies are clustered at the lower end of the ranking scale, indicating better healthcare quality and prevention outcomes. Conversely, states with “most restrictive” abortion policies show higher rankings, reflecting poorer performance in healthcare quality and prevention metrics. The trend suggests that states with protective abortion policies may prioritize robust healthcare systems, integrating reproductive health within broader preventative and quality-focused frameworks. In contrast, states with restrictive abortion policies consistently rank worse, potentially indicating less emphasis on preventative care or healthcare quality. This highlights how restrictive reproductive healthcare policies may correlate with broader systemic healthcare shortcomings, potentially exacerbating health inequities in those states.\n\n\nCode\nkruskal_test &lt;- kruskal.test(health_care_quality_and_prevention ~ abortion_policies, data = df)\nprint(kruskal_test)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  health_care_quality_and_prevention by abortion_policies\nKruskal-Wallis chi-squared = 14.09, df = 6, p-value = 0.02865\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests \npairwise.wilcox.test(df$health_care_quality_and_prevention,\n                     df$abortion_policies, p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$health_care_quality_and_prevention and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              0.87            1.00            0.16      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          0.34       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nThe Kruskal-Wallis test yielded a chi-squared statistic of 22.583 (df = 6, p = 0.02865), indicating statistically significant differences in healthcare quality and prevention rankings across the seven levels of abortion policy restrictiveness. This result aligns with the observations from the boxplot, suggesting that states with more protective abortion policies tend to perform better in healthcare quality and prevention rankings, while more restrictive policies are associated with poorer outcomes.\n\n\nCode\n# Run Jonckheere-Terpstra test\n\njt_test &lt;- jonckheere.test(df$health_care_quality_and_prevention, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 698.5, p-value = 0.0018\nalternative hypothesis: increasing\n\n\n\n\nCode\n# Permutation Test Implementation for Health Care Quality and Prevention\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(health_care_quality_and_prevention ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) # For reproducibility\nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$health_care_quality_and_prevention &lt;- sample(permuted_data$health_care_quality_and_prevention)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(health_care_quality_and_prevention ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 2.812286 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0186 \n\n\n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"olivedrab4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nA permutation test was performed on the healthcare quality and prevention data in addition to the Kruskal-Wallis test to ensure the robustness of the findings across different statistical methods. The permutation test yielded a statistically significant p-value of 0.0186, confirming evidence that healthcare quality and prevention rankings differ among at least one of the abortion policy levels. This reinforces the conclusion that abortion policy restrictiveness is associated with variations in healthcare quality and prevention outcomes across states.\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Calculate the overall average\noverall_avg &lt;- mean(df$health_care_quality_and_prevention, na.rm = TRUE)\n\n# Filter and classify observations as Above or Below Average\ndf &lt;- df %&gt;%\n  filter(!is.na(abortion_policies) & !is.na(health_care_quality_and_prevention)) %&gt;% \n  mutate(above_or_below = if_else(health_care_quality_and_prevention &gt; overall_avg, \n                                  \"Above Average\", \"Below Average\"))\n\n# Group and count observations\ndf_count &lt;- df %&gt;%\n  group_by(abortion_policies, above_or_below) %&gt;%\n  summarize(count = n(), .groups = \"drop\")\n\n# Convert counts to percentages\ndf_count &lt;- df_count %&gt;%\n  group_by(abortion_policies) %&gt;%\n  mutate(percentage = count / sum(count) * 100)\n\n# Create the stacked bar chart\nggplot(df_count, aes(x = abortion_policies, y = percentage, fill = above_or_below)) +\n  geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.7) +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"Above Average\" = \"#ff0000\", \"Below Average\" = \"#1c7416\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Percentage of Observations\",\n       fill = \"Comparison to Average\",\n       title = \"Percentage of Above/Below Average Health Care Quality and Prevention\\nby Abortion Policy\") +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        plot.title = element_text(size = 10, hjust = 0.5),\n        axis.title.y = element_text(size = 10))\n\n\n\n\n\n\n\n\n\n\n\nHealth Outcomes by Abortion Policy\n\n\nCode\nggplot(df, aes(x = abortion_policies, y = health_outcomes, fill = abortion_policies)) +\n  geom_boxplot() +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(\n    title = \"Health Outcomes by Abortion Policies\",\n    x = \"Abortion Policies\",\n    y = \"Health Outcomes\",\n    fill = \"Abortion Policies\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 12),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"right\"\n  )\n\n\n\n\n\n\n\n\n\nThis boxplot illustrates the relationship between abortion policies and health outcomes, where a lower number/rank indicates better outcomes. States with “most protective” abortion policies demonstrate the best health outcomes, with rankings clustered toward the lower end of the scale. As abortion policies become increasingly restrictive, health outcomes generally worsen, with rankings shifting higher. States with “most restrictive” abortion policies exhibit the poorest health outcomes, with a higher concentration of rankings near the bottom of the boxplot.\nThese trends suggest that states with more restrictive abortion policies may lack broader investments in public health infrastructure and services, contributing to poorer overall health outcomes. In contrast, states with protective abortion policies might prioritize comprehensive healthcare systems that address a wider array of health determinants. This disparity underscores the broader implications of policy decisions on public health and well-being, highlighting potential inequities in access to essential healthcare resources.\n\n\nCode\nkruskal_test &lt;- kruskal.test(health_outcomes ~ abortion_policies, data = df)\nprint(kruskal_test)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  health_outcomes by abortion_policies\nKruskal-Wallis chi-squared = 21.669, df = 6, p-value = 0.00139\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests \npairwise.wilcox.test(df$health_outcomes,\n                     df$abortion_policies, p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$health_outcomes and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.000           -               -         \nprotective                    1.000           1.000           -         \nsome restrictions/protections 1.000           1.000           1.000     \nrestrictive                   1.000           1.000           1.000     \nvery restrictive              1.000           1.000           1.000     \nmost restrictive              1.000           0.076           0.014     \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.000                         -          \nvery restrictive              1.000                         1.000      \nmost restrictive              0.485                         0.211      \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.000           \n\nP value adjustment method: bonferroni \n\n\nThe Kruskal-Wallis test for health outcomes across abortion policy levels reveals a chi-squared value of 21.669 with 6 degrees of freedom and a p-value of 0.00139. This statistically significant result indicates that health outcomes vary meaningfully across at least one level of abortion policy. This reinforces the trends observed in the boxplot: states with “most protective” abortion policies tend to achieve better health outcomes, while those with “most restrictive” policies are associated with worse rankings.\n\n\nCode\n#Jonckheere test\n\njt_test &lt;- jonckheere.test(df$health_outcomes, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 808.5, p-value = 1e-04\nalternative hypothesis: increasing\n\n\n\n\nCode\n# Permutation Test Implementation for Health Outcomes by Abortion Policy\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(health_outcomes ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) # For reproducibility\nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$health_outcomes &lt;- sample(permuted_data$health_outcomes)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(health_outcomes ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 5.608316 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 2e-04 \n\n\n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen3\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nA permutation test was performed on health outcomes by abortion policy to validate the findings from the Kruskal-Wallis test. The observed F-statistic was 5.608316, and the permutation test yielded a p-value of 0.0002, which is statistically significant.\nThis result supports the conclusion that health outcomes vary significantly across abortion policy levels. The visualization of the permutation distribution shows that the observed F-statistic lies far to the right of the simulated null distribution, providing strong evidence that these differences are unlikely to have arisen by chance. These findings underscore the measurable impact of abortion policy restrictiveness on broader health outcomes, indicating systemic disparities in public health quality across states.\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Calculate the overall average\noverall_avg &lt;- mean(df$health_outcomes, na.rm = TRUE)\n\n# Filter and classify observations as Above or Below Average\ndf &lt;- df %&gt;%\n  filter(!is.na(abortion_policies) & !is.na(health_outcomes)) %&gt;% \n  mutate(above_or_below = if_else(health_outcomes &gt; overall_avg, \n                                  \"Above Average\", \"Below Average\"))\n\n# Group and count observations\ndf_count &lt;- df %&gt;%\n  group_by(abortion_policies, above_or_below) %&gt;%\n  summarize(count = n(), .groups = \"drop\")\n\n# Convert counts to percentages\ndf_count &lt;- df_count %&gt;%\n  group_by(abortion_policies) %&gt;%\n  mutate(percentage = count / sum(count) * 100)\n\n# Create the stacked bar chart\nggplot(df_count, aes(x = abortion_policies, y = percentage, fill = above_or_below)) +\n  geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.7) +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"Above Average\" = \"#ff0000\", \"Below Average\" = \"#1c7416\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Percentage of Observations\",\n       fill = \"Comparison to Average\",\n       title = \"Percentage of Above/Below Average Health Outcomes by Abortion Policy\") +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        plot.title = element_text(size = 10, hjust = 0.5),\n        axis.title.y = element_text(size = 10))\n\n\n\n\n\n\n\n\n\n\n\nOBGYN Ratios by Abortion Policy\n\n\nCode\n# Create the OB-GYN ratio per 100,000 women first\ndf &lt;- df %&gt;%\n  filter(!is.na(number_of_obstetricians_and_gynecologists_employed_2023) &\n         !is.na(total_sumber_of_women_aged_15_44_2017)) %&gt;%\n  mutate(obgyn_per_100k = (number_of_obstetricians_and_gynecologists_employed_2023 / \n                          total_sumber_of_women_aged_15_44_2017) * 100000)\n\n# Create ordered factor levels for abortion policies\npolicy_levels &lt;- c(\n  \"most protective\",\n  \"very protective\", \n  \"protective\",\n  \"some restrictions/protections\",\n  \"restrictive\",\n  \"very restrictive\",\n  \"most restrictive\"\n)\n\n# Convert abortion_policies to factor with ordered levels\ndf$abortion_policies &lt;- factor(df$abortion_policies, levels = policy_levels)\n\n# Create the plot\nggplot(df, aes(x = abortion_policies, y = obgyn_per_100k, fill = abortion_policies)) +\n  geom_boxplot(width = 0.7) +\n  scale_fill_manual(\n    values = c(\n      \"most protective\" = \"#1c7416\",\n      \"very protective\" = \"#68bb59\",\n      \"protective\" = \"#acdf87\",\n      \"some restrictions/protections\" = \"#fab733\",\n      \"restrictive\" = \"#ff6242\",\n      \"very restrictive\" = \"#ff0000\",\n      \"most restrictive\" = \"#c61a09\"\n    )\n  ) +\n  labs(\n    x = \"Abortion Policies\",\n    y = \"OB-GYNs per 100,000 Women Ages 15-44\",\n    title = \"Distribution of OB-GYN Access by State Abortion Policy (2023)\",\n    fill = \"Abortion Policy\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 12),\n    axis.title.x = element_text(size = 10, margin = margin(t = 10)),\n    axis.title.y = element_text(size = 10),\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),\n    axis.text.y = element_text(size = 8),\n    legend.position = \"none\",\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.background = element_rect(fill = \"white\", color = NA),\n    panel.background = element_rect(fill = \"white\", color = NA)\n  ) +\n  scale_y_continuous(\n    limits = c(0, max(df$obgyn_per_100k, na.rm = TRUE) * 1.1),\n    expand = expansion(mult = c(0, 0.1))\n  )\n\n\n\n\n\n\n\n\n\nNote: It’s critical to consider the mismatch in timeframes for the data (OB-GYN numbers from 2023 and population data from 2017), which could introduce inaccuracies. This table serves as a starting point for understanding disparities in healthcare access by abortion policy and underscores the need for more recent and comprehensive data to draw robust conclusions.\nThis boxplot illustrates the ratio of OB-GYNs to women aged 15-44 across states with varying abortion policy classifications. States with more protective abortion policies tend to have higher ratios of OB-GYNs to women, as indicated by the greater median and interquartile ranges for these groups. Conversely, states with more restrictive abortion policies exhibit lower OB-GYN-to-women ratios, reflected in their comparatively lower medians and more compressed distributions.\nThese findings suggest that states prioritizing access to abortion services may also allocate resources to ensure greater availability of OB-GYNs, enhancing access to comprehensive reproductive healthcare. On the other hand, states with restrictive abortion policies may not only limit reproductive healthcare access through policy but may also have fewer OB-GYNs available, compounding the barriers for women in accessing necessary medical care.\n\n\nCode\n# First, calculate the observed F-statistic\nobserved_anova &lt;- aov(obgyn_per_100k ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Perform permutation test\nset.seed(1234) # For reproducibility\nN &lt;- 100000 # Number of permutations\nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  permuted_data &lt;- df\n  permuted_data$obgyn_per_100k &lt;- sample(permuted_data$obgyn_per_100k) # Fixed assignment\n  \n  perm_anova &lt;- aov(obgyn_per_100k ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate the p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\n# Print results\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 1.683609 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.15428 \n\n\n\n\nCode\nhist(perm_F, \n     main = \"Distribution of F-statistics under Null Hypothesis\",\n     xlab = \"F-statistic\",\n     breaks = 50)\nabline(v = observed_F, col = \"red\", lwd = 2)\n\n\n\n\n\n\n\n\n\nThe permutation test for the ratio of OB-GYNs to women aged 15–44 yields an observed F-statistic of 5.608316 with a highly significant p-value of 0.0003. This result indicates that there is strong evidence to suggest that the distribution of OB-GYN ratios significantly varies across abortion policy categories. The significant result underscores that states with differing abortion policies also exhibit distinct disparities in OB-GYN accessibility, pointing to potential inequities in access to reproductive healthcare resources. - I think wrong u were looking at means of categories but idk bc the boxplot looks significant\n\n\nCode\nkruskal_test &lt;- kruskal.test(obgyn_per_100k ~ abortion_policies, data = df)\nprint(kruskal_test)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  obgyn_per_100k by abortion_policies\nKruskal-Wallis chi-squared = 9.0958, df = 6, p-value = 0.1683\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests \npairwise.wilcox.test(df$obgyn_per_100k,\n                     df$abortion_policies, p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$obgyn_per_100k and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              1.00            0.75            0.63      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\np-val also high\n\n\nCode\njt_test &lt;- jonckheere.test(df$obgyn_per_100k, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"decreasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 275, p-value = 0.007\nalternative hypothesis: decreasing\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Calculate the overall average\noverall_avg &lt;- mean(df$obgyn_per_100k, na.rm = TRUE)\n\n# Filter and classify observations as Above or Below Average\ndf &lt;- df %&gt;%\n  filter(!is.na(abortion_policies) & !is.na(obgyn_per_100k)) %&gt;% \n  mutate(above_or_below = if_else(obgyn_per_100k &gt; overall_avg, \n                                  \"Above Average\", \"Below Average\"))\n\n# Group and count observations\ndf_count &lt;- df %&gt;%\n  group_by(abortion_policies, above_or_below) %&gt;%\n  summarize(count = n(), .groups = \"drop\")\n\n# Convert counts to percentages\ndf_count &lt;- df_count %&gt;%\n  group_by(abortion_policies) %&gt;%\n  mutate(percentage = count / sum(count) * 100)\n\n# Create the stacked bar chart\nggplot(df_count, aes(x = abortion_policies, y = percentage, fill = above_or_below)) +\n  geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.7) +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"Above Average\" = \"#1c7416\", \"Below Average\" = \"#ff0000\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Percentage of Observations\",\n       fill = \"Comparison to Average\",\n       title = \"Percentage of Above/Below Average OBGYN Ratio by Abortion Policy\") +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        plot.title = element_text(size = 10, hjust = 0.5),\n        axis.title.y = element_text(size = 10))"
  },
  {
    "objectID": "results/maternal_health.html",
    "href": "results/maternal_health.html",
    "title": "Maternal Health",
    "section": "",
    "text": "Null hypothesis: the maternal mortality rate is the same across different abortion policies.\nAlternative hypothesis: the maternal mortality rate in at least one abortion policy group is different from the rest.\n\n\nCode\nlibrary(tidyverse)\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\ndf &lt;- df[!is.na(df$abortion_policies), ]\ndf_test &lt;- df[df$State != \"US\", ]\n\n\n\n\nCode\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n# Kruskal-Wallis test\nkruskal.test(`maternal_mortality_rates_2020_2022_per_100,000_live births` ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  maternal_mortality_rates_2020_2022_per_100,000_live births by abortion_policies\nKruskal-Wallis chi-squared = 15.751, df = 6, p-value = 0.01516\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$`maternal_mortality_rates_2020_2022_per_100,000_live births`, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$`maternal_mortality_rates_2020_2022_per_100,000_live births` and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              0.73            0.12            0.17      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = `maternal_mortality_rates_2020_2022_per_100,000_live births`, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Maternal Morality rate per 100,000\",\n       title = \"Maternal Mortality Rate by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))\n\n\nWarning: Removed 8 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test yields a p-value of 0.009736, providing significant evidence to suggest that the null hypothesis can be rejected and we can say that in at least one policy group, the maternal mortality rate is different from the rest. This accompanying visualization provides us additional insight into the characteristics of this difference(s). As we can see, the maternal mortality rates in the most restrictive abortion policy states have the largest and highest range and the greatest mean mortality rate. The mean mortality rate in the most protective states appears to be the lowest (or tied with the rate in the protective policy states). The visualization shows that for the most part, as the restrictiveness of abortion policy increases, so does the mean maternal mortality rate.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'clinfun' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpCglHZD\\downloaded_packages\n\n\nCode\nlibrary(clinfun)\n\n\nWarning: package 'clinfun' was built under R version 4.4.2\n\n\nCode\njt_test &lt;- jonckheere.test(df$\"maternal_mortality_rates_2020_2022_per_100,000_live births\", \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 545, p-value = 1e-04\nalternative hypothesis: increasing\n\n\nTo further confirm these findings, we will perform a permutation test on the ANOVA mean differences:\n\n\nCode\n# Permutation Test\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(`maternal_mortality_rates_2020_2022_per_100,000_live births` ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$`maternal_mortality_rates_2020_2022_per_100,000_live births` &lt;- sample(permuted_data$`maternal_mortality_rates_2020_2022_per_100,000_live births`)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(`maternal_mortality_rates_2020_2022_per_100,000_live births` ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 3.595385 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0067 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nThe permutation test also yields a statistically significant p-value, further providing evidence to suggest a true mean difference in maternal mortality rates among abortion policy groups.\nAbortions are critical for preserving maternal health and mortality. There are many situations in which an abortion is life-saving for the mother. By restricting or banning abortions, more mothers are at risk for maternal mortality by being prohibited or limited in accessing or being treated with necessary measures. If abortions are banned or heavily restricted, it is reasonable to assume that maternal mortality would increase in those states as more women suffer the effects of a complicated or terminal pregnancy without intervention. Additionally, prohibiting abortion forces women who aren’t ready to have babies to give birth, even if they are too young, facing other health risks or problems, or don’t have the financial resources or health insurance to access adequate care during pregnancy, which are all risk factors for maternal mortality.\nWhen states choose to implement the restrictive abortion policies, even with data on maternal mortality in their state, they are consciously establishing conditions that could exacerbate preventable deaths in women."
  },
  {
    "objectID": "results/maternal_health.html#maternal-morality-by-abortion-policy",
    "href": "results/maternal_health.html#maternal-morality-by-abortion-policy",
    "title": "Maternal Health",
    "section": "",
    "text": "Null hypothesis: the maternal mortality rate is the same across different abortion policies.\nAlternative hypothesis: the maternal mortality rate in at least one abortion policy group is different from the rest.\n\n\nCode\nlibrary(tidyverse)\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\ndf &lt;- df[!is.na(df$abortion_policies), ]\ndf_test &lt;- df[df$State != \"US\", ]\n\n\n\n\nCode\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n# Kruskal-Wallis test\nkruskal.test(`maternal_mortality_rates_2020_2022_per_100,000_live births` ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  maternal_mortality_rates_2020_2022_per_100,000_live births by abortion_policies\nKruskal-Wallis chi-squared = 15.751, df = 6, p-value = 0.01516\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$`maternal_mortality_rates_2020_2022_per_100,000_live births`, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$`maternal_mortality_rates_2020_2022_per_100,000_live births` and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              0.73            0.12            0.17      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = `maternal_mortality_rates_2020_2022_per_100,000_live births`, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Maternal Morality rate per 100,000\",\n       title = \"Maternal Mortality Rate by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))\n\n\nWarning: Removed 8 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test yields a p-value of 0.009736, providing significant evidence to suggest that the null hypothesis can be rejected and we can say that in at least one policy group, the maternal mortality rate is different from the rest. This accompanying visualization provides us additional insight into the characteristics of this difference(s). As we can see, the maternal mortality rates in the most restrictive abortion policy states have the largest and highest range and the greatest mean mortality rate. The mean mortality rate in the most protective states appears to be the lowest (or tied with the rate in the protective policy states). The visualization shows that for the most part, as the restrictiveness of abortion policy increases, so does the mean maternal mortality rate.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'clinfun' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpCglHZD\\downloaded_packages\n\n\nCode\nlibrary(clinfun)\n\n\nWarning: package 'clinfun' was built under R version 4.4.2\n\n\nCode\njt_test &lt;- jonckheere.test(df$\"maternal_mortality_rates_2020_2022_per_100,000_live births\", \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 545, p-value = 1e-04\nalternative hypothesis: increasing\n\n\nTo further confirm these findings, we will perform a permutation test on the ANOVA mean differences:\n\n\nCode\n# Permutation Test\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(`maternal_mortality_rates_2020_2022_per_100,000_live births` ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$`maternal_mortality_rates_2020_2022_per_100,000_live births` &lt;- sample(permuted_data$`maternal_mortality_rates_2020_2022_per_100,000_live births`)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(`maternal_mortality_rates_2020_2022_per_100,000_live births` ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 3.595385 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0067 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nThe permutation test also yields a statistically significant p-value, further providing evidence to suggest a true mean difference in maternal mortality rates among abortion policy groups.\nAbortions are critical for preserving maternal health and mortality. There are many situations in which an abortion is life-saving for the mother. By restricting or banning abortions, more mothers are at risk for maternal mortality by being prohibited or limited in accessing or being treated with necessary measures. If abortions are banned or heavily restricted, it is reasonable to assume that maternal mortality would increase in those states as more women suffer the effects of a complicated or terminal pregnancy without intervention. Additionally, prohibiting abortion forces women who aren’t ready to have babies to give birth, even if they are too young, facing other health risks or problems, or don’t have the financial resources or health insurance to access adequate care during pregnancy, which are all risk factors for maternal mortality.\nWhen states choose to implement the restrictive abortion policies, even with data on maternal mortality in their state, they are consciously establishing conditions that could exacerbate preventable deaths in women."
  },
  {
    "objectID": "results/maternal_health.html#women-who-went-without-care-due-to-cost-by-abortion-policy",
    "href": "results/maternal_health.html#women-who-went-without-care-due-to-cost-by-abortion-policy",
    "title": "Maternal Health",
    "section": "Women who Went Without Care due to Cost by Abortion Policy",
    "text": "Women who Went Without Care due to Cost by Abortion Policy\nNull hypothesis: the mean percentage of women who went without care because of cost is the same in each abortion policy group.\nAlternative hypothesis: the mean percentage of women who went without care because of cost is different in at least one of the abortion policy groups.\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(women_18_44_who_went_without_care_because_of_cost ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  women_18_44_who_went_without_care_because_of_cost by abortion_policies\nKruskal-Wallis chi-squared = 14.043, df = 6, p-value = 0.02916\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$women_18_44_who_went_without_care_because_of_cost, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$women_18_44_who_went_without_care_because_of_cost and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            0.59            0.72      \nvery restrictive              1.00            0.21            0.31      \nmost restrictive              1.00            0.90            0.75      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = women_18_44_who_went_without_care_because_of_cost, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women Without Care per 100,000\",\n       title = \"Percentage of Women who went Without Care due to Cost by Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test here yields a statistically significant p-value of 0.01516, indicating evidence to accept the alternative hypothesis and suggest that the true mean percentage of women who went without care because of cost is different in at least one of the abortion policy more. The boxplot visualization indicates the scope of these differences. The plot demonstrates a clear relationship where as the abortion policy becomes more strict, the higher the mean percentage of women who did not receive care due to it being too expensive for them to afford. It appears that the mean percentage of women going without care in the most protective abortion policy states is about 12%, whereas in the states with the most restrictive abortion policy, the mean is about 18%.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nWarning: package 'clinfun' is in use and will not be installed\n\n\nCode\nlibrary(clinfun)\n\njt_test &lt;- jonckheere.test(df$women_18_44_who_went_without_care_because_of_cost, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 740.5, p-value = 4e-04\nalternative hypothesis: increasing\n\n\nTo confirm the strength of the difference in means, we will perform a permutation test:\n\n\nCode\n# Permutation Test\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(women_18_44_who_went_without_care_because_of_cost ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$women_18_44_who_went_without_care_because_of_cost &lt;- sample(permuted_data$women_18_44_who_went_without_care_because_of_cost)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(women_18_44_who_went_without_care_because_of_cost ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 2.329356 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0496 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nThe p-value produced by the permutation test is 0.496, which is extremely close to the alpha level we are using of 0.05. This p-value suggests that while the likelihood of observing the observed ANOVA test statistic under the null hypothesis is very low, it is not as low as in other tests we’ve seen. It may be more appropriate to say that the permutation test provides moderately strong evidence to suggest that there is a true difference in the mean percentage of women who went without care due to cost in states with different abortion policy levels.\nThese findings highlight how in states that chose to implement restrictive abortion bans, there were already problems with women being unable to access adequate maternal care due to costs. Adding restrictive abortion measures, which has indirect effects on the quality and accessibility of other maternal health resources, would add an extra layer of difficulty to women who need maternal care but aren’t able to afford it."
  },
  {
    "objectID": "results/maternal_health.html#percentage-of-uninsured-women-during-pregnancy-in-2021-by-abortion-policy",
    "href": "results/maternal_health.html#percentage-of-uninsured-women-during-pregnancy-in-2021-by-abortion-policy",
    "title": "Maternal Health",
    "section": "Percentage of Uninsured Women During Pregnancy in 2021 by Abortion Policy",
    "text": "Percentage of Uninsured Women During Pregnancy in 2021 by Abortion Policy\nNull hypothesis: The percentage of uninsured women during pregnancy in 2021 is the same in all abortion policy groups.\nAlternative hypothesis: The percentage of uninsured women during pregnancy in 2021 is different in at least one abortion policy level.\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(percent_uninsured_women_during_pregnancy_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  percent_uninsured_women_during_pregnancy_2021 by abortion_policies\nKruskal-Wallis chi-squared = 13.576, df = 6, p-value = 0.03475\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$percent_uninsured_women_during_pregnancy_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$percent_uninsured_women_during_pregnancy_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            0.59            0.17      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              1.00            1.00            1.00      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = percent_uninsured_women_during_pregnancy_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women Uninsured\",\n       title = \"Percentage of Women Uninsured During Pregnancy \\nby Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test yields a p-value of 0.03475, providing significant evidence to reject the null hypothesis in favor of the alternative and suggest that the percentage of uninsured women during pregnancy is different in at least one of the abortion policy level groups. The boxplots give us some insight into the nature of these differences. Interestingly, the mean percentage of uninsured women during pregnancy appears to increase as the restrictiveness of abortion policy increases, until the most restrictive level where the mean and range drop significantly. It is difficult to understand why this may be. However, the clear trend among the previous six groups appears to be a significant indicator of the maternal population characteristics of the states in those levels.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nWarning: package 'clinfun' is in use and will not be installed\n\n\nCode\nlibrary(clinfun)\n\njt_test &lt;- jonckheere.test(df$percent_uninsured_women_during_pregnancy_2021, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 297.5, p-value = 0.0072\nalternative hypothesis: increasing\n\n\nWhile the p-value produced was moderately strong, we will not perform an ANOVA permutation test to further validate the significance of these associations:\n\n\nCode\n# Permutation Test\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(percent_uninsured_women_during_pregnancy_2021 ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$percent_uninsured_women_during_pregnancy_2021 &lt;- sample(permuted_data$percent_uninsured_women_during_pregnancy_2021)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(percent_uninsured_women_during_pregnancy_2021 ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 4.561629 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0252 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nThe permutation test yields a p-value of 0.0252, which is statistically stronger than the p-value yielded by the Kruskal-Wallis test. This confirms that we have statistically significant evidence to suggest a difference in percentage of uninsured women during pregnancy in 2021 in at least one of the abortion policy levels."
  },
  {
    "objectID": "results/maternal_health.html#teen-birth-rate-by-abortion-policy",
    "href": "results/maternal_health.html#teen-birth-rate-by-abortion-policy",
    "title": "Maternal Health",
    "section": "Teen Birth Rate by Abortion Policy",
    "text": "Teen Birth Rate by Abortion Policy\n\n\nCode\ncolnames(df)\n\n\n  [1] \"State\"                                                            \n  [2] \"parental_leave_mandatory_enacted\"                                 \n  [3] \"parental_leave_mandatory_not_yet_enacted\"                         \n  [4] \"parental_leave_voluntary\"                                         \n  [5] \"parental_leave_job_protection\"                                    \n  [6] \"num_weeks_parental_leave\"                                         \n  [7] \"percent_women_working\"                                            \n  [8] \"pctg_women_uninsured\"                                             \n  [9] \"avg_infant_childcare_price_2018\"                                  \n [10] \"avg_infant_childcare_price_2023\"                                  \n [11] \"avg_infant_childcare_price_as_share_of_fam_income_2018\"           \n [12] \"maternal_mortality_mothers_race_is_black_2017_2022\"               \n [13] \"maternal_mortality_mothers_race_is_white_2017_2022\"               \n [14] \"maternal_mortality_rate_2018\"                                     \n [15] \"maternal_mortality_rate_2019\"                                     \n [16] \"maternal_mortality_rate_2020_without_covid\"                       \n [17] \"maternal_mortality_rate_2021_without_covid\"                       \n [18] \"maternal_mortality_rate_2022\"                                     \n [19] \"maternal_mortality_rate_2023\"                                     \n [20] \"number_of_obstetricians_and_gynecologists_employed_2023\"          \n [21] \"total_sumber_of_women_aged_15_44_2017\"                            \n [22] \"maternal_mortality_rates_2020_2022_per_100,000_live births\"       \n [23] \"infant_mortality_2021\"                                            \n [24] \"infant_mortality_2017\"                                            \n [25] \"infant_mortality_2018\"                                            \n [26] \"infant_mortality_2019\"                                            \n [27] \"infant_mortality_2020\"                                            \n [28] \"infant_mortality_2021_old\"                                        \n [29] \"infant_mortality_2022\"                                            \n [30] \"women_18_44_who_went_without_care_because_of_cost\"                \n [31] \"overall_health_ranking\"                                           \n [32] \"birth_rate_2021\"                                                  \n [33] \"birth_rate_2022\"                                                  \n [34] \"birth_rate_2023\"                                                  \n [35] \"birth_rate_2024\"                                                  \n [36] \"percent_of_pregnancies_ending_in birth_2017\"                      \n [37] \"percent_of_pregnancies_ending_in_abortion_2017\"                   \n [38] \"percent_of_births_financed_by_medicaid\"                           \n [39] \"birth_rate_per_1,000_women_ages_15_44\"                            \n [40] \"teen_birth_rate_per_1,000_population_ages_15_19_2022\"             \n [41] \"increase_in_clinician_provided_abortions_since_2020\"              \n [42] \"total_infant_mortality_white\"                                     \n [43] \"total_infant_mortality_black\"                                     \n [44] \"total_infant_mortality_hispanic\"                                  \n [45] \"women_with_depression_before_or_during_pregnancy_2021\"            \n [46] \"women_18_44_who_went_without_care_because_of_cost.1\"              \n [47] \"overall_health_ranking.1\"                                         \n [48] \"coverage_access_and_affordability\"                                \n [49] \"health_care_quality_and_prevention\"                               \n [50] \"health_outcomes\"                                                  \n [51] \"all_cause_mortality_rate_per_100,000_women_ages 15_44_2022\"       \n [52] \"birth_rate_per_1,000 women_ages_15_44\"                            \n [53] \"teen_birth_rate_per_1,000_population_ages_15_19_2022.1\"           \n [54] \"percent_increase_in_clinician_provided_abortions_since_2020\"      \n [55] \"percent_women_ages_18_64_who_report_fair_or_poor_health_2022\"     \n [56] \"percent_women_with_postpartum_depression_2021\"                    \n [57] \"percent_women_who_received_a_postpartum_depression_screening_2021\"\n [58] \"percent_women_experiencing_intimate_partner_violence_2021\"        \n [59] \"percent_uninsured_women_during_pregnancy_2021\"                    \n [60] \"percent_uninsured_women_ages 19_64\"                               \n [61] \"abortion_clinics_per_100,000_women_ages_15_44_2022\"               \n [62] \"maternity_care_workforce_per_100,000_women_ages_15_44\"            \n [63] \"percent_women_ages_18_44_without_a_usual_source_of_care\"          \n [64] \"abortion_policies\"                                                \n [65] \"abortion_related_legislative_actions_introduced_2023\"             \n [66] \"medicaid_expansion_status\"                                        \n [67] \"total_abortion_ban\"                                               \n [68] \"week_ban_6\"                                                       \n [69] \"week_ban_12\"                                                      \n [70] \"week_ban_15\"                                                      \n [71] \"week_ban_18_to_23\"                                                \n [72] \"week_ban_24_to_26\"                                                \n [73] \"no_gestational_ban\"                                               \n [74] \"state_constitution_excludes_abortion_rights\"                      \n [75] \"waiting_period_after_counseling\"                                  \n [76] \"waiting_period_after_required_in_person_counseling\"               \n [77] \"forced_ultrasound\"                                                \n [78] \"state_medicaid_coverage_ban\"                                      \n [79] \"private_insurance_coverage_ban\"                                   \n [80] \"medication_abortion_in_person_requirement\"                        \n [81] \"mailing_abortion_pills_banned\"                                    \n [82] \"medically_unnecessary_clinic_regulations\"                         \n [83] \"parental_consent_required_for_minors_abortion\"                    \n [84] \"parental_notice_required_for_a_minors_abortion\"                   \n [85] \"only_physicians_can_provide_abortions\"                            \n [86] \"state_constitution_protects_abortion_rights\"                      \n [87] \"state_medicaid_funds_cover_abortion\"                              \n [88] \"private_health_plans_required_to_cover_abortion\"                  \n [89] \"healthcare_professionals_besides_physicians_provide_abortions\"    \n [90] \"state_fund_for_abortion_care\"                                     \n [91] \"protections_to_enter_a_clinic\"                                    \n [92] \"shield_law_protecting_providers\"                                  \n [93] \"patient_reproductive_health_data_privacy\"                         \n [94] \"prenatal_and_postpartum_home_visits_2017\"                         \n [95] \"infant_care_parenting_education_2017\"                             \n [96] \"postpartum_visit_2017\"                                            \n [97] \"state_requires_coverage_of_prescription_contraception\"            \n [98] \"twenty_five_and_older_had_bachelors_by_higher_2021\"               \n [99] \"less_than_highschool\"                                             \n[100] \"overall_school_rank\"                                              \n[101] \"percentage_women_BA_or_higher\"                                    \n[102] \"foster_children_per_capita\"                                       \n\n\n\n\nCode\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n# Kruskal-Wallis test\nkruskal.test(`teen_birth_rate_per_1,000_population_ages_15_19_2022` ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  teen_birth_rate_per_1,000_population_ages_15_19_2022 by abortion_policies\nKruskal-Wallis chi-squared = 25.544, df = 6, p-value = 0.0002706\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$`teen_birth_rate_per_1,000_population_ages_15_19_2022`, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$`teen_birth_rate_per_1,000_population_ages_15_19_2022` and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.0000          -               -         \nprotective                    1.0000          1.0000          -         \nsome restrictions/protections 1.0000          1.0000          1.0000    \nrestrictive                   1.0000          1.0000          1.0000    \nvery restrictive              1.0000          1.0000          1.0000    \nmost restrictive              0.2745          0.0353          0.0058    \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.0000                        -          \nvery restrictive              1.0000                        1.0000     \nmost restrictive              0.1713                        0.0310     \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              0.6155          \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = `teen_birth_rate_per_1,000_population_ages_15_19_2022`, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Teen Birth Rate per 100,000\",\n       title = \"Teen Birth Rate by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test here yields a statistically significant p-value of 0.0002706, indicating evidence to accept the alternative hypothesis and suggest that the\n\n\nCode\njt_test &lt;- jonckheere.test(df$\"teen_birth_rate_per_1,000_population_ages_15_19_2022\", \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 838.5, p-value = 1e-04\nalternative hypothesis: increasing\n\n\n\n\nCode\n# Permutation Test\nN &lt;- 100000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(`teen_birth_rate_per_1,000_population_ages_15_19_2022` ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$`teen_birth_rate_per_1,000_population_ages_15_19_2022` &lt;- sample(permuted_data$`teen_birth_rate_per_1,000_population_ages_15_19_2022`)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(`teen_birth_rate_per_1,000_population_ages_15_19_2022` ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 7.771021 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 1e-05 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\ninterpret\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"corrplot\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'corrplot' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpCglHZD\\downloaded_packages\n\n\nCode\nlibrary(corrplot)\n\n\nWarning: package 'corrplot' was built under R version 4.4.2\n\n\ncorrplot 0.95 loaded\n\n\nCode\nhealth_correlation_analysis &lt;- function(data) {\n  selected_cols &lt;- data[, c(\n    \"teen_birth_rate_per_1,000_population_ages_15_19_2022\",\n    \"infant_mortality_2021\",\n    \"maternal_mortality_rates_2020_2022_per_100,000_live births\",\n    \"health_outcomes\",\n    \"overall_health_ranking\"\n  )]\n  \n  names(selected_cols) &lt;- c(\n    \"Teen Birth Rate\",\n    \"Infant Mortality\",\n    \"Maternal Mortality\",\n    \"Health Outcomes\",\n    \"Overall Health\"\n  )\n  \n  complete_data &lt;- na.omit(selected_cols)\n \n  cor_matrix &lt;- cor(complete_data)\n  \n  corrplot(cor_matrix, \n          method = \"color\",\n          type = \"upper\",\n          order = \"hclust\",\n          addCoef.col = \"black\",\n          number.cex = 0.7,\n          tl.col = \"black\",\n          tl.srt = 45,\n          diag = FALSE,\n          col = colorRampPalette(c(\"#E5F5E0\", \"#74C476\", \"#005A32\"))(200))  \n  \n  return(list(\n    correlations = cor_matrix,\n    sample_size = nrow(complete_data),\n    original_size = nrow(selected_cols)\n  ))\n}\n\nresults &lt;- health_correlation_analysis(df)\n\n\n\n\n\n\n\n\n\nCode\nprint(\"Correlation Matrix:\")\n\n\n[1] \"Correlation Matrix:\"\n\n\nCode\nprint(round(results$correlations, 3))\n\n\n                   Teen Birth Rate Infant Mortality Maternal Mortality\nTeen Birth Rate              1.000            0.818              0.749\nInfant Mortality             0.818            1.000              0.634\nMaternal Mortality           0.749            0.634              1.000\nHealth Outcomes              0.918            0.816              0.721\nOverall Health               0.863            0.712              0.693\n                   Health Outcomes Overall Health\nTeen Birth Rate              0.918          0.863\nInfant Mortality             0.816          0.712\nMaternal Mortality           0.721          0.693\nHealth Outcomes              1.000          0.868\nOverall Health               0.868          1.000\n\n\nCode\nprint(paste(\"\\nAnalysis based on\", results$sample_size, \"complete observations out of\", results$original_size, \"total states\"))\n\n\n[1] \"\\nAnalysis based on 43 complete observations out of 51 total states\"\n\n\n\n\nCode\nlibrary(corrplot)\n\nhealth_education_correlation &lt;- function(data) {\n  # Select relevant columns\n  selected_cols &lt;- data[, c(\n    \"teen_birth_rate_per_1,000_population_ages_15_19_2022\",\n    \"percentage_women_BA_or_higher\",\n    \"percent_women_working\"\n  )]\n  \n  # Rename columns for better readability\n  names(selected_cols) &lt;- c(\n    \"Teen_Birth_Rate\",\n    \"Women_with_BA\",\n    \"Women_Working\"\n  )\n  \n  # Remove rows with missing values\n  complete_data &lt;- na.omit(selected_cols)\n  \n  # Calculate correlation matrix\n  cor_matrix &lt;- cor(complete_data)\n  \n  # Set margins\n  par(mar = c(2, 2, 1, 2))\n  \n  # Create correlation plot\n  corrplot(cor_matrix, \n          method = \"color\",\n          type = \"upper\",\n          order = \"hclust\",\n          addCoef.col = \"black\",\n          number.cex = 0.7,\n          tl.col = \"black\",\n          tl.srt = 45,\n          diag = FALSE,\n          col = colorRampPalette(c(\"#E5F5E0\", \"#74C476\", \"#005A32\"))(200),\n          title = \"Teen Birth Rate, Education, and Socioeconomic Correlations\",\n          mar = c(0,0,1,0))\n  \n  return(list(\n    correlations = cor_matrix,\n    sample_size = nrow(complete_data),\n    original_size = nrow(selected_cols)\n  ))\n}\n\n# Run the analysis\nresults &lt;- health_education_correlation(df)\n\n\n\n\n\n\n\n\n\nCode\nprint(\"Correlation Matrix:\")\n\n\n[1] \"Correlation Matrix:\"\n\n\nCode\nprint(round(results$correlations, 3))\n\n\n                Teen_Birth_Rate Women_with_BA Women_Working\nTeen_Birth_Rate           1.000        -0.775        -0.577\nWomen_with_BA            -0.775         1.000         0.646\nWomen_Working            -0.577         0.646         1.000\n\n\nCode\nprint(paste(\"\\nAnalysis based on\", results$sample_size, \"complete observations out of\", results$original_size, \"total states\"))\n\n\n[1] \"\\nAnalysis based on 50 complete observations out of 51 total states\"\n\n\n\n\nCode\ndf_filtered &lt;- df %&gt;%\n  filter(!is.na(`maternal_mortality_rates_2020_2022_per_100,000_live births`)) %&gt;%\n  bind_rows(tibble(\n    State = c(\"US Average\", \"Tennessee\"),\n    `maternal_mortality_rates_2020_2022_per_100,000_live births` = c(23.2, 51.1),\n    abortion_policies = c(\"US Average\", \"most restrictive\") \n  ))\n\npolicy_levels &lt;- c(\n  \"most protective\",\n  \"very protective\", \n  \"protective\",\n  \"some restrictions/protections\",\n  \"restrictive\",\n  \"very restrictive\",\n  \"most restrictive\",\n  \"US Average\"\n)\n\ndf_filtered$abortion_policies &lt;- factor(df_filtered$abortion_policies, \n                                      levels = policy_levels)\n\nggplot(df_filtered, \n       aes(y = reorder(State, `maternal_mortality_rates_2020_2022_per_100,000_live births`),\n           x = `maternal_mortality_rates_2020_2022_per_100,000_live births`,\n           fill = abortion_policies)) +\n  geom_bar(stat = \"identity\", width = 0.7) +\n  scale_fill_manual(\n    values = c(\n      \"most protective\" = \"#1c7416\",\n      \"very protective\" = \"#68bb59\",\n      \"protective\" = \"#acdf87\",\n      \"some restrictions/protections\" = \"#fab733\",\n      \"restrictive\" = \"#ff6242\",\n      \"very restrictive\" = \"#ff0000\",\n      \"most restrictive\" = \"#c61a09\",\n      \"US Average\" = \"#006eff\"\n    ),\n    breaks = policy_levels\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Maternal Mortality Rates (2020-2022) per 100,000 Live Births by State\",\n    x = \"Maternal Mortality Rate per 100,000 Live Births\",\n    y = \"\",\n    fill = \"Abortion Policy\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 12),\n    axis.title.x = element_text(size = 10),\n    axis.text.y = element_text(size = 8),\n    axis.text.x = element_text(size = 8),\n    legend.position = \"right\",\n    legend.title = element_text(size = 9),\n    legend.text = element_text(size = 8),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.background = element_rect(fill = \"white\", color = NA),\n    panel.background = element_rect(fill = \"white\", color = NA)\n  ) +\n  scale_x_continuous(\n    limits = c(0, 55),  \n    breaks = seq(0, 55, by = 10),\n    expand = expansion(mult = c(0, 0.1))\n  )\n\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_bar()`)."
  },
  {
    "objectID": "results/child_health.html",
    "href": "results/child_health.html",
    "title": "Child Health",
    "section": "",
    "text": "Code\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"tidyverse\")\n\n\npackage 'tidyverse' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpikY10b\\downloaded_packages\n\n\nCode\nlibrary(tidyverse)\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\ndf &lt;- df[!is.na(df$abortion_policies), ]\ndf_test &lt;- df[df$State != \"US\", ]\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\n\nNull hypothesis: the mean infant mortality rate is the same across all abortion policy levels\nAlternative hypothesis: the mean infant mortality rate is different in at least one of the abortion policy levels\n\n\nCode\ndf$infant_mortality_2021\n\n\n [1] 7.6 7.4 5.5 8.6 4.1 5.0 4.7 4.8 6.8 5.9 6.3 4.7 5.1 5.6 6.8 4.0 5.3 6.2 7.2\n[20] 5.0 6.0 3.2 6.2 4.8 9.4 5.9 4.9 5.5 5.8 4.0 3.6 4.8 4.2 6.7 2.8 7.1 7.1 3.8\n[39] 5.4 4.3 7.3 6.1 6.2 5.3 4.6 3.2 6.0 4.4 6.8 5.4 5.5\n\n\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(infant_mortality_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  infant_mortality_2021 by abortion_policies\nKruskal-Wallis chi-squared = 17.01, df = 6, p-value = 0.009246\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$infant_mortality_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$infant_mortality_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              0.61            0.17            0.22      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          0.80       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = infant_mortality_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Infant Morality rate per 1,000\",\n       title = \"Infant Mortality Rate by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test yields a statistically significant p-value of 0.009246, which provides strong evidence to suggest that we can reject the null hypothesis in favor of the alternative and speculate that the true mean infant mortality rate is different in at least one of the policy groups— in other words, we have evidence to suggest that there is a relationship between abortion policy and infant mortality in U.S. states.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'clinfun' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpikY10b\\downloaded_packages\n\n\nCode\nlibrary(clinfun)\n\n\nWarning: package 'clinfun' was built under R version 4.4.2\n\n\nCode\njt_test &lt;- jonckheere.test(df$infant_mortality_2021, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 773.5, p-value = 1e-04\nalternative hypothesis: increasing\n\n\nTo further confirm these results, we will perform an ANOVA permutation test:\n\n\nCode\n# Permutation Test\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(infant_mortality_2021 ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$infant_mortality_2021 &lt;- sample(permuted_data$infant_mortality_2021)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(infant_mortality_2021 ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 3.827105 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0048 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nThe ANOVA permutation test yields a p-value of 0.0048, which further supports our rejection of the null hypothesis in favor of the alternative under the Kruskal-Wallis test. Therefore, we have additional evidence to suggest that there is a difference in infant mortality rates in states with different abortion policies.\n\n\nCode\ndf_filtered &lt;- df %&gt;%\n  filter(!is.na(`infant_mortality_2021`)) %&gt;%\n  bind_rows(tibble(\n    State = \"US Average\",  # Removed c() since only adding one value\n    `infant_mortality_2021` = 5.4,\n    abortion_policies = \"US Average\"  # Removed \"most restrictive\" since only adding US Average\n  ))\n\npolicy_levels &lt;- c(\n  \"most protective\",\n  \"very protective\", \n  \"protective\",\n  \"some restrictions/protections\",\n  \"restrictive\",\n  \"very restrictive\",\n  \"most restrictive\",\n  \"US Average\"\n)\n\ndf_filtered$abortion_policies &lt;- factor(df_filtered$abortion_policies, \n                                      levels = policy_levels)\n\nggplot(df_filtered, \n       aes(y = reorder(State, `infant_mortality_2021`),\n           x = `infant_mortality_2021`,\n           fill = abortion_policies)) +\n  geom_bar(stat = \"identity\", width = 0.7) +\n  scale_fill_manual(\n    values = c(\n      \"most protective\" = \"#1c7416\",\n      \"very protective\" = \"#68bb59\",\n      \"protective\" = \"#acdf87\",\n      \"some restrictions/protections\" = \"#fab733\",\n      \"restrictive\" = \"#ff6242\",\n      \"very restrictive\" = \"#ff0000\",\n      \"most restrictive\" = \"#c61a09\",\n      \"US Average\" = \"#006eff\"\n    ),\n    breaks = policy_levels\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Infant Mortality Rate by State (2021)\",  # Made title more concise\n    x = \"Deaths per 1,000 Live Births\",  # Corrected units\n    y = \"\",\n    fill = \"Abortion Policy\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 12),\n    axis.title.x = element_text(size = 10),\n    axis.text.y = element_text(size = 8),\n    axis.text.x = element_text(size = 8),\n    legend.position = \"right\",\n    legend.title = element_text(size = 9),\n    legend.text = element_text(size = 8),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.background = element_rect(fill = \"white\", color = NA),\n    panel.background = element_rect(fill = \"white\", color = NA)\n  ) +\n  scale_x_continuous(\n    limits = c(0, 15),\n    breaks = seq(0, 15, by = 5),  # Changed to increments of 5 for better readability\n    expand = expansion(mult = c(0, 0.1))\n  )"
  },
  {
    "objectID": "results/child_health.html#infant-mortality-by-abortion-policy",
    "href": "results/child_health.html#infant-mortality-by-abortion-policy",
    "title": "Child Health",
    "section": "",
    "text": "Code\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"tidyverse\")\n\n\npackage 'tidyverse' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpikY10b\\downloaded_packages\n\n\nCode\nlibrary(tidyverse)\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\ndf &lt;- df[!is.na(df$abortion_policies), ]\ndf_test &lt;- df[df$State != \"US\", ]\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\n\nNull hypothesis: the mean infant mortality rate is the same across all abortion policy levels\nAlternative hypothesis: the mean infant mortality rate is different in at least one of the abortion policy levels\n\n\nCode\ndf$infant_mortality_2021\n\n\n [1] 7.6 7.4 5.5 8.6 4.1 5.0 4.7 4.8 6.8 5.9 6.3 4.7 5.1 5.6 6.8 4.0 5.3 6.2 7.2\n[20] 5.0 6.0 3.2 6.2 4.8 9.4 5.9 4.9 5.5 5.8 4.0 3.6 4.8 4.2 6.7 2.8 7.1 7.1 3.8\n[39] 5.4 4.3 7.3 6.1 6.2 5.3 4.6 3.2 6.0 4.4 6.8 5.4 5.5\n\n\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(infant_mortality_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  infant_mortality_2021 by abortion_policies\nKruskal-Wallis chi-squared = 17.01, df = 6, p-value = 0.009246\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$infant_mortality_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$infant_mortality_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              0.61            0.17            0.22      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          0.80       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying boxplot visualization\n# accompanying boxplot visualization\nggplot(df, aes(x = abortion_policies, y = infant_mortality_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Infant Morality rate per 1,000\",\n       title = \"Infant Mortality Rate by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test yields a statistically significant p-value of 0.009246, which provides strong evidence to suggest that we can reject the null hypothesis in favor of the alternative and speculate that the true mean infant mortality rate is different in at least one of the policy groups— in other words, we have evidence to suggest that there is a relationship between abortion policy and infant mortality in U.S. states.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'clinfun' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpikY10b\\downloaded_packages\n\n\nCode\nlibrary(clinfun)\n\n\nWarning: package 'clinfun' was built under R version 4.4.2\n\n\nCode\njt_test &lt;- jonckheere.test(df$infant_mortality_2021, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 773.5, p-value = 1e-04\nalternative hypothesis: increasing\n\n\nTo further confirm these results, we will perform an ANOVA permutation test:\n\n\nCode\n# Permutation Test\nN &lt;- 10000 \n\n# Observed ANOVA F-statistic\nobserved_anova &lt;- aov(infant_mortality_2021 ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\n# Permutation loop\nset.seed(1234) \nperm_F &lt;- numeric(N)\n\nfor (i in 1:N) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$infant_mortality_2021 &lt;- sample(permuted_data$infant_mortality_2021)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(infant_mortality_2021 ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 3.827105 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0048 \n\n\nCode\n# Plot the permutation F-statistics\nhist(perm_F, \n     breaks = 30, \n     main = \"Permutation Distribution of F-statistic\", \n     xlab = \"F-statistic\", \n     col = \"palegreen4\",  \n     border = \"white\")    \n\n# F-statistic line \nabline(v = observed_F, \n       col = \"red\",       \n       lwd = 2, \n       lty = 2)\n\n\n\n\n\n\n\n\n\nThe ANOVA permutation test yields a p-value of 0.0048, which further supports our rejection of the null hypothesis in favor of the alternative under the Kruskal-Wallis test. Therefore, we have additional evidence to suggest that there is a difference in infant mortality rates in states with different abortion policies.\n\n\nCode\ndf_filtered &lt;- df %&gt;%\n  filter(!is.na(`infant_mortality_2021`)) %&gt;%\n  bind_rows(tibble(\n    State = \"US Average\",  # Removed c() since only adding one value\n    `infant_mortality_2021` = 5.4,\n    abortion_policies = \"US Average\"  # Removed \"most restrictive\" since only adding US Average\n  ))\n\npolicy_levels &lt;- c(\n  \"most protective\",\n  \"very protective\", \n  \"protective\",\n  \"some restrictions/protections\",\n  \"restrictive\",\n  \"very restrictive\",\n  \"most restrictive\",\n  \"US Average\"\n)\n\ndf_filtered$abortion_policies &lt;- factor(df_filtered$abortion_policies, \n                                      levels = policy_levels)\n\nggplot(df_filtered, \n       aes(y = reorder(State, `infant_mortality_2021`),\n           x = `infant_mortality_2021`,\n           fill = abortion_policies)) +\n  geom_bar(stat = \"identity\", width = 0.7) +\n  scale_fill_manual(\n    values = c(\n      \"most protective\" = \"#1c7416\",\n      \"very protective\" = \"#68bb59\",\n      \"protective\" = \"#acdf87\",\n      \"some restrictions/protections\" = \"#fab733\",\n      \"restrictive\" = \"#ff6242\",\n      \"very restrictive\" = \"#ff0000\",\n      \"most restrictive\" = \"#c61a09\",\n      \"US Average\" = \"#006eff\"\n    ),\n    breaks = policy_levels\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Infant Mortality Rate by State (2021)\",  # Made title more concise\n    x = \"Deaths per 1,000 Live Births\",  # Corrected units\n    y = \"\",\n    fill = \"Abortion Policy\"\n  ) +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 12),\n    axis.title.x = element_text(size = 10),\n    axis.text.y = element_text(size = 8),\n    axis.text.x = element_text(size = 8),\n    legend.position = \"right\",\n    legend.title = element_text(size = 9),\n    legend.text = element_text(size = 8),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.background = element_rect(fill = \"white\", color = NA),\n    panel.background = element_rect(fill = \"white\", color = NA)\n  ) +\n  scale_x_continuous(\n    limits = c(0, 15),\n    breaks = seq(0, 15, by = 5),  # Changed to increments of 5 for better readability\n    expand = expansion(mult = c(0, 0.1))\n  )"
  },
  {
    "objectID": "bibliography.html",
    "href": "bibliography.html",
    "title": "Bibliography",
    "section": "",
    "text": "References\n\nAdkins, S., Talmor, N., White, M. H., Dutton, C., & O’Donoghue, A. L. (2024). Association between restricted abortion access and child entries into the foster care system. JAMA Pediatrics, 178(1), 37–44.\n\n\nBureau of Labor Statistics. (2024). Number of obstetricians and gynecologists employed in the united states in 2023, by state [graph]. In Statista.\n\n\nCohen, D. S., Donley, G., & Rebouché, R. (2023). The new abortion battleground. Colum. L. Rev., 123, 1.\n\n\nCollins, S. R., & al., et. (2024). 2024 state scorecard on women’s health and reproductive care. Commonwealth Fund.\n\n\nGuttmacher, A. F. (1956). Factors affecting normal expectancy of conception. Journal of the American Medical Association, 161(9), 855–860.\n\n\nHoyert, D. L. (2023). Maternal mortality rates in the united states, 2021. NCHS Health E-Stats. https://doi.org/10.15620/cdc:124678\n\n\nKaiser Family Foundation (KFF). (2024). State health facts: Births financed by medicaid.\n\n\nO’Neill, S. (2022). Fertility trends and the rising costs of children.\n\n\nStevenson, A. J. (2021b). The pregnancy-related mortality impact of a total abortion ban in the united states: A research note on increased deaths due to remaining pregnant. Demography, 58(6), 2019–2028.\n\n\nStevenson, A. J. (2021a). The Pregnancy-Related Mortality Impact of a Total Abortion Ban in the United States: A Research Note on Increased Deaths Due to Remaining Pregnant. Demography, 58(6), 2019–2028. https://doi.org/10.1215/00703370-9585908\n\n\nWallace, M. E., Stoecker, C., Sauter, S., & Vilda, D. (2024). States’ abortion laws associated with intimate partner violence–related homicide of women and girls in the US, 2014–20: Study examines the association of abortion laws to intimate partner violence of women and girls. Health Affairs, 43(5), 682–690.\n\n\nWallace, M., Gillispie-Bell, V., Cruz, K., Davis, K., & Vilda, D. (2021). Homicide during pregnancy and the postpartum period in the united states, 2018–2019. Obstetrics & Gynecology, 138(5), 762–769."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "appendix.html",
    "href": "appendix.html",
    "title": "DSAN 5100",
    "section": "",
    "text": "[Download Slides](slides.pdf)"
  },
  {
    "objectID": "complications.html",
    "href": "complications.html",
    "title": "Complications & Unsafe Abortion",
    "section": "",
    "text": "Unfortunately, we were unable to find reliable and accessible data on complications and unsafe abortions. Several factors may contribute to this lack of information. Initially, we sought to explore whether miscarriage rates varied by state, how unsafe abortion rates evolved over time, illegal abortion rates, and data on women whose lives were endangered by the inability to access safe abortion services. However, these datasets either do not exist or are difficult to locate, as we encountered significant challenges in finding trustworthy sources.\nMany elements might be responsible for this dearth of information. It may, for instance, be difficult or unrealistic to report on all miscarriages. Furthermore, there are stringent regulations surrounding all research done on pregnant women for obvious reasons. Data on unsafe or illegal abortions might not exists because these procedures may go unreported. However, the absence of these data sets is telling in and of itself, and is an issue for women’s health and public health on the whole regardless of political perspective or affiliation."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Conditions Impacting Maternal Wellness by US State",
    "section": "",
    "text": "Abortion is a unique and contentious political issue in the United States. In 1973, the landmark Supreme Court case Roe v. Wade established the constitutional right to abortion on a federal level. However, in 2022, this decision was overturned by the same court, making abortion regulation a state-level issue. This reversal intensified the political divide, with Democrats and liberals typically advocating for abortion rights, while Republicans and conservatives strongly opposed them. Despite this polarized political landscape, public opinion surveys consistently show that a majority of Americans support the right to abortion. For example, a 2022 Pew Research study highlights widespread support for abortion access across various demographics (Adkins et al. 2024).\nAbortion policy now varies significantly across states, reflecting the political leanings of their governments. Some states have enacted sweeping bans or severe restrictions, while others have worked to protect or expand access. This disparity has led to profound public health implications, as the ability to access abortion services is intrinsically tied to maternal and child health outcomes. A visualization of the geographic variability is shown below.\n\nTraditionally, debates around abortion have been framed in moral and ethical terms, which often overshadow empirical evidence and data. While ethical considerations are important, this perspective tends to neglect the measurable impact of abortion policy on health and well-being. In this research project, we aim to take a data-driven approach to objectively examine how abortion policy affects maternal wellness across the United States.\nOur central research question is: How do state-level abortion policies impact maternal well-being, and what broader factors contribute to state-to-state variation in these outcomes?\nTo answer this question, we will analyze public health data at the state level, using abortion policy as a key variable. By doing so, we hope to provide a more concrete, evidence-based understanding of the relationship between abortion policy and maternal health. Ultimately, this research seeks to contribute to the broader policy discourse by grounding it in the lived experiences and health outcomes of women."
  },
  {
    "objectID": "index.html#problem-objectives",
    "href": "index.html#problem-objectives",
    "title": "Conditions Impacting Maternal Wellness by US State",
    "section": "",
    "text": "Abortion is a unique and contentious political issue in the United States. In 1973, the landmark Supreme Court case Roe v. Wade established the constitutional right to abortion on a federal level. However, in 2022, this decision was overturned by the same court, making abortion regulation a state-level issue. This reversal intensified the political divide, with Democrats and liberals typically advocating for abortion rights, while Republicans and conservatives strongly opposed them. Despite this polarized political landscape, public opinion surveys consistently show that a majority of Americans support the right to abortion. For example, a 2022 Pew Research study highlights widespread support for abortion access across various demographics (Adkins et al. 2024).\nAbortion policy now varies significantly across states, reflecting the political leanings of their governments. Some states have enacted sweeping bans or severe restrictions, while others have worked to protect or expand access. This disparity has led to profound public health implications, as the ability to access abortion services is intrinsically tied to maternal and child health outcomes. A visualization of the geographic variability is shown below.\n\nTraditionally, debates around abortion have been framed in moral and ethical terms, which often overshadow empirical evidence and data. While ethical considerations are important, this perspective tends to neglect the measurable impact of abortion policy on health and well-being. In this research project, we aim to take a data-driven approach to objectively examine how abortion policy affects maternal wellness across the United States.\nOur central research question is: How do state-level abortion policies impact maternal well-being, and what broader factors contribute to state-to-state variation in these outcomes?\nTo answer this question, we will analyze public health data at the state level, using abortion policy as a key variable. By doing so, we hope to provide a more concrete, evidence-based understanding of the relationship between abortion policy and maternal health. Ultimately, this research seeks to contribute to the broader policy discourse by grounding it in the lived experiences and health outcomes of women."
  },
  {
    "objectID": "index.html#context-case-studies",
    "href": "index.html#context-case-studies",
    "title": "Conditions Impacting Maternal Wellness by US State",
    "section": "Context & Case Studies",
    "text": "Context & Case Studies\n\nSince the reversal of Roe v. Wade in 2022, numerous stories have emerged illustrating the devastating impact of abortion bans on women and children’s health. For example, a study by Stevenson (2021) projected a 7% increase in maternal mortality in the first year following widespread abortion bans, with the rate rising to 23% in the subsequent year (Stevenson 2021). These findings highlight the immediate and severe health risks associated with restrictive abortion policies. Notably, vulnerable populations, including racial minorities and those with low socioeconomic status, are disproportionately affected.\nWhile maternal mortality is one critical measure, it is only one piece of the larger picture. Well-being encompasses a wide range of factors, including access to prenatal care, economic stability, and the mental health of mothers and families. These indicators often vary widely across states, driven by differences in healthcare infrastructure, economic resources, and social support."
  },
  {
    "objectID": "index.html#research-questions",
    "href": "index.html#research-questions",
    "title": "Conditions Impacting Maternal Wellness by US State",
    "section": "Research Questions",
    "text": "Research Questions\nData science question: what conditions cause variation in maternal wellness by state? \n\nWhat is the association of abortion policy and infant/maternal mortality? \nWhat is the association of race and  infant/maternal mortality? \nWhat is the association of healthcare quality and abortion policy? \nWhat is the association of healthcare quality and infant and maternal mortality? \nWhat is the association between mandated policy (for example parental leave) and abortion policy?\nDo states with policies that make conditions for women having babies more difficult, tend to have higher infant and maternal mortality rates? \n\nParental leave \nAbortion laws \n\nDo states with stricter maternal condition policies have worse healthcare?\n\n\n\n\n\n\nflowchart TD\n\n  A(Association Between Abortion Policy and Health Outcomes):::main\n\n  A --&gt; B(Maternal Health)\n  B --&gt; X(Maternal Mortality)\n  B --&gt; V(Cost Barriers)\n  B --&gt; H(Uninsured Women During Pregnancy)\n\n  A --&gt; C(Maternal Wellness)\n  C --&gt; G(Economic Wellness)\n  G --&gt; W(Parental Leave)\n  G --&gt; I(Women in the Workforce)\n  G --&gt; J(Teen Birth Rate)\n  C --&gt; K(Education Wellness)\n  K --&gt; L(Higher Education)\n  C --&gt; M(Mental Health)\n  M --&gt; N(Postpartum Depression)\n  M --&gt; O(Intimate Partner Violence)\n  \n  \n  A --&gt; D(Overall Health)\n  D --&gt; P(Ratio of OBGYN)\n  D --&gt; Q(Health Coverage)\n  D --&gt; R(Medicaid Expansion)\n  D --&gt; S(Contraception Coverage)\n\n  A --&gt; E(Child Health )\n  E --&gt; T(Infant Mortality)\n  \n  A --&gt; F(Child Wellness)\n  F --&gt; U(Foster Care)"
  },
  {
    "objectID": "results/child_wellness.html",
    "href": "results/child_wellness.html",
    "title": "Child Wellness EDA",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(readr)\nCode\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\ndf &lt;- df[!is.na(df$abortion_policies), ]\nCode\ntable(df$abortion_policies)\n\n\n\n              most protective              most restrictive \n                            2                            16 \n                   protective                   restrictive \n                           10                             7 \nsome restrictions/protections               very protective \n                            5                             7 \n             very restrictive \n                            4"
  },
  {
    "objectID": "results/child_wellness.html#number-of-children-in-foster-care-per-100000-children-by-abortion-policy",
    "href": "results/child_wellness.html#number-of-children-in-foster-care-per-100000-children-by-abortion-policy",
    "title": "Child Wellness EDA",
    "section": "Number of Children in Foster Care per 100,000 Children, by Abortion Policy",
    "text": "Number of Children in Foster Care per 100,000 Children, by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(foster_children_per_capita ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  foster_children_per_capita by abortion_policies\nKruskal-Wallis chi-squared = 8.5234, df = 6, p-value = 0.2022\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$foster_children_per_capita, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$foster_children_per_capita and df$abortion_policies \n\n                              most protective most restrictive protective\nmost restrictive              1.00            -                -         \nprotective                    1.00            1.00             -         \nrestrictive                   1.00            1.00             1.00      \nsome restrictions/protections 1.00            1.00             1.00      \nvery protective               1.00            0.57             0.48      \nvery restrictive              1.00            1.00             1.00      \n                              restrictive some restrictions/protections\nmost restrictive              -           -                            \nprotective                    -           -                            \nrestrictive                   -           -                            \nsome restrictions/protections 1.00        -                            \nvery protective               0.80        1.00                         \nvery restrictive              1.00        1.00                         \n                              very protective\nmost restrictive              -              \nprotective                    -              \nrestrictive                   -              \nsome restrictions/protections -              \nvery protective               -              \nvery restrictive              1.00           \n\nP value adjustment method: bonferroni \n\n\nCode\n# For visualization\n# First reorder the factor levels\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                             levels = c(\"most restrictive\", \n                                      \"very restrictive\", \n                                      \"restrictive\",\n                                      \"some restrictions/protections\",\n                                      \"protective\",\n                                      \"very protective\",\n                                      \"most protective\"))\n\n# Then create the plot\n# For visualization\n# First reorder the factor levels\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\n# Then create the plot\nggplot(df, aes(x = abortion_policies, y = foster_children_per_capita, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Foster Children per Capita\",\n       title = \"Foster Care Rates by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))\n\n\nWarning: Removed 1 row containing non-finite outside the scale range\n(`stat_boxplot()`)."
  },
  {
    "objectID": "results/child_wellness.html#overall-school-system-ranking-by-abortion-policy",
    "href": "results/child_wellness.html#overall-school-system-ranking-by-abortion-policy",
    "title": "Child Wellness EDA",
    "section": "Overall School System Ranking by Abortion Policy",
    "text": "Overall School System Ranking by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(overall_school_rank ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  overall_school_rank by abortion_policies\nKruskal-Wallis chi-squared = 6.1441, df = 6, p-value = 0.4072\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$overall_school_rank, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum exact test \n\ndata:  df$overall_school_rank and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              1.00            1.00            1.00      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          0.98       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# For visualization\nggplot(df, aes(x = abortion_policies, y = overall_school_rank, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Overall School Ranking\",\n       title = \"Public School System Rankings by Abortion Policy\") +\n  theme(plot.title = element_text(size = 20, hjust = 0.5))"
  },
  {
    "objectID": "results/maternal_wellness.html",
    "href": "results/maternal_wellness.html",
    "title": "Maternal Wellness - Statistical Modeling",
    "section": "",
    "text": "Code\noptions(repos = c(CRAN = \"https://cran.r-project.org\"))\ninstall.packages(\"tidyverse\")\n\n\npackage 'tidyverse' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpGKi79t\\downloaded_packages\n\n\nCode\nlibrary(tidyverse)\nlibrary(readr)\ndf &lt;- read_csv(\"../data/clean_data/merged_data.csv\", show_col_types = FALSE)\ndf &lt;- df[!is.na(df$abortion_policies), ]"
  },
  {
    "objectID": "results/maternal_wellness.html#economic-wellness",
    "href": "results/maternal_wellness.html#economic-wellness",
    "title": "Maternal Wellness - Statistical Modeling",
    "section": "Economic Wellness",
    "text": "Economic Wellness\n\nParental Leave by Abortion Policy\n\n\nCode\n# reorder the levels of abortion policies\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\n# create variable combining states that have declared parental leave policy as of now, even if not enacted\ndf$parental_leave_mandatory &lt;- pmax(df$parental_leave_mandatory_enacted, df$parental_leave_mandatory_not_yet_enacted)\n\n# stacked bar plot\nggplot(df, aes(x = as.factor(parental_leave_mandatory), fill = abortion_policies)) +\n  geom_bar(position = \"fill\") +\n  labs(x = \"Parental leave policy\", \n       y = \"Proportion\", \n       fill = \"Level of state abortion policy\",\n       title = \"State Abortion Policies by Parental Leave Requirements\") +\n  scale_x_discrete(labels = c(\"0\" = \"Not Mandated\", \"1\" = \"Mandated\")) +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  theme_classic()\n\n\n\n\n\n\n\n\n\nThis plot shows us that while the vast majority of states that have not enacted mandatory parental leave have more restrictive abortion policies, the vast majority of states that do mandate parental leave have protective abortion policies. So, the states that want to prohibit women from accessing contraceptive care also enable the worst conditions for a woman when she has a baby: an unfavorable and unprotected employment situation.\n\n\nCode\n# fisher's exact test\ncontingency_table &lt;- table(df$parental_leave_mandatory, df$abortion_policies)\n\nfisher_test_result &lt;- fisher.test(contingency_table)\nprint(fisher_test_result)\n\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 6.816e-05\nalternative hypothesis: two.sided\n\n\nThe p-value produced from Fisher’s Exact Test indicates that we have significant evidence to suggest that abortion policy and mandatory parental leave policy are not independent of each other. This suggests that levels of abortion_policies are strongly related to whether parental leave is mandatory.\nNow we will perform logistic regression to investigate the direction of this relationship:\n\n\nCode\n# check assumptions \n\n# sample size \ntable(df$parental_leave_mandatory, df$abortion_policies)\n\n\n   \n    most protective very protective protective some restrictions/protections\n  0               1               2          4                             3\n  1               1               5          6                             2\n   \n    restrictive very restrictive most restrictive\n  0           7                4               16\n  1           0                0                0\n\n\nCode\n# the sample sizes are too small, so we must use exact logistic regression to account for this size and separation\n\n\n\n\nCode\n# order the levels of abortion policy\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                               levels = c(\"most restrictive\", \n                                          \"very restrictive\", \n                                          \"restrictive\", \n                                          \"some restrictions/protections\", \n                                          \"protective\", \n                                          \"very protective\", \n                                          \"most protective\"))\n\nlibrary(logistf)\n\n\nWarning: package 'logistf' was built under R version 4.4.2\n\n\nCode\n# Fit the exact logistic regression model\nfit &lt;- logistf(parental_leave_mandatory ~ factor(abortion_policies), data = df)\n\n# View the results\nsummary(fit)\n\n\nlogistf(formula = parental_leave_mandatory ~ factor(abortion_policies), \n    data = df)\n\nModel fitted by Penalized ML\nCoefficients:\n                                                             coef se(coef)\n(Intercept)                                            -3.4965076 1.435481\nfactor(abortion_policies)very restrictive               1.2992830 2.069500\nfactor(abortion_policies)restrictive                    0.7884574 2.047911\nfactor(abortion_policies)some restrictions/protections  3.1600353 1.657203\nfactor(abortion_policies)protective                     3.8642323 1.560985\nfactor(abortion_policies)very protective                4.2849649 1.625554\nfactor(abortion_policies)most protective                3.4965076 1.842265\n                                                       lower 0.95 upper 0.95\n(Intercept)                                            -8.3448894  -1.499056\nfactor(abortion_policies)very restrictive              -3.9858138   6.588116\nfactor(abortion_policies)restrictive                   -4.4758771   6.053943\nfactor(abortion_policies)some restrictions/protections  0.4062025   8.175971\nfactor(abortion_policies)protective                     1.4626807   8.807042\nfactor(abortion_policies)very protective                1.7307768   9.283523\nfactor(abortion_policies)most protective                0.2091242   8.681275\n                                                            Chisq            p\n(Intercept)                                            19.0554958 1.269716e-05\nfactor(abortion_policies)very restrictive               0.3735875 5.410552e-01\nfactor(abortion_policies)restrictive                    0.1450325 7.033284e-01\nfactor(abortion_policies)some restrictions/protections  5.1499418 2.324715e-02\nfactor(abortion_policies)protective                    12.0956887 5.053855e-04\nfactor(abortion_policies)very protective               13.1051061 2.944920e-04\nfactor(abortion_policies)most protective                4.3329275 3.738190e-02\n                                                       method\n(Intercept)                                                 2\nfactor(abortion_policies)very restrictive                   2\nfactor(abortion_policies)restrictive                        2\nfactor(abortion_policies)some restrictions/protections      2\nfactor(abortion_policies)protective                         2\nfactor(abortion_policies)very protective                    2\nfactor(abortion_policies)most protective                    2\n\nMethod: 1-Wald, 2-Profile penalized log-likelihood, 3-None\n\nLikelihood ratio test=22.39574 on 6 df, p=0.0010263, n=51\nWald test = 13.13625 on 6 df, p = 0.04092253\n\n\nCode\n# Generate predicted probabilities\ndf$predicted_prob &lt;- predict(fit, type = \"response\")\n\n# visualize\nggplot(df, aes(x = abortion_policies, y = predicted_prob)) +\n  geom_point(position = position_jitter(width = 0.2), alpha = 0.6) +\n  stat_summary(fun = mean, geom = \"point\", color = \"blue\", size = 3) +\n  labs(x = \"Abortion Policies\", \n       y = \"Predicted Probability\",\n       title = \"Mandatory Parental Leave Policy \\nPredicted Probabilities by Abortion Policy\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\nThe exact logistic regression model yields a p-value of 0.0010263, revealing that there is sufficient evidence to suggest that there is a sloped relationship between whether or not a state has mandatory abortion policy and the degree of their abortion policy restrictiveness/protectiveness. The slope coefficients and the visualization indicate that the slope between the abortion policy level and having parental leave legislation (y=1) gets more positive as the policy level gets more protective regarding abortion. This indicates that states that have abortion policies that are protective for women are more likely to also have mandatory parental leave policy than states with restrictive abortion policy. This is important, because it means that the states that choose to make abortion less accessible and therefore force women to have babies, also foster conditions that make it incredibly difficult for women to have babies. This highlights a lack of care for mothers’ wellbeing and financial stability in states with restrictive abortion rights.\n\n\nParental Leave Job Protection by Abortion Policy\n\n\nCode\n# reorder the levels of abortion policies\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\n# stacked bar plot\nggplot(df, aes(x = as.factor(parental_leave_job_protection), fill = abortion_policies)) +\n  geom_bar(position = \"fill\") +\n  labs(x = \"Parental leave job protection policy\", \n       y = \"Proportion\", \n       fill = \"Level of state abortion policy\",\n       title = \"State Abortion Policies by Job Protection Requirements\") +\n  scale_x_discrete(labels = c(\"0\" = \"No Job Protection\", \"1\" = \"Job Protection\")) +\n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  theme_classic() +\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n\n\n\n\n\n\n\nCode\n# fisher's exact test\ncontingency_table &lt;- table(df$parental_leave_job_protection, df$abortion_policies)\n\nfisher_test_result &lt;- fisher.test(contingency_table)\nprint(fisher_test_result)\n\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  contingency_table\np-value = 0.006869\nalternative hypothesis: two.sided\n\n\nFisher’s Exact Test yields a p-value of 0.006869, which indicates that we have sufficient evidence to suggest that there is an association between a state’s abortion policies and whether or not they have policy for job protection when a parent takes parental leave.\n\n\nCode\n# check assumptions: \n# tabulate categories to see if sample sizes are sufficient\ntable(df$parental_leave_job_protection, df$abortion_policies)\n\n\n   \n    most protective very protective protective some restrictions/protections\n  0               1               4          6                             3\n  1               1               3          4                             2\n   \n    restrictive very restrictive most restrictive\n  0           7                4               16\n  1           0                0                0\n\n\nCode\n# since the sample sizes are insufficient, we must use exact logistic regression \n\n\n\n\nCode\n# order the levels of abortion policy\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                               levels = c(\"most restrictive\", \n                                          \"very restrictive\", \n                                          \"restrictive\", \n                                          \"some restrictions/protections\", \n                                          \"protective\", \n                                          \"very protective\", \n                                          \"most protective\"))\n\nlibrary(logistf)\n\n# Fit the exact logistic regression model\nfit &lt;- logistf(parental_leave_job_protection ~ factor(abortion_policies), data = df)\n\n# View the results\nsummary(fit)\n\n\nlogistf(formula = parental_leave_job_protection ~ factor(abortion_policies), \n    data = df)\n\nModel fitted by Penalized ML\nCoefficients:\n                                                             coef se(coef)\n(Intercept)                                            -3.4965076 1.435481\nfactor(abortion_policies)very restrictive               1.2992830 2.069500\nfactor(abortion_policies)restrictive                    0.7884574 2.047911\nfactor(abortion_policies)some restrictions/protections  3.1600353 1.657203\nfactor(abortion_policies)protective                     3.1287828 1.560985\nfactor(abortion_policies)very protective                3.2451931 1.602667\nfactor(abortion_policies)most protective                3.4965076 1.842265\n                                                       lower 0.95 upper 0.95\n(Intercept)                                            -8.3448894  -1.499056\nfactor(abortion_policies)very restrictive              -3.9858138   6.588116\nfactor(abortion_policies)restrictive                   -4.4758771   6.053943\nfactor(abortion_policies)some restrictions/protections  0.4062025   8.175971\nfactor(abortion_policies)protective                     0.6945336   8.069477\nfactor(abortion_policies)very protective                0.6799392   8.218484\nfactor(abortion_policies)most protective                0.2091242   8.681275\n                                                            Chisq            p\n(Intercept)                                            19.0554958 1.269716e-05\nfactor(abortion_policies)very restrictive               0.3735875 5.410552e-01\nfactor(abortion_policies)restrictive                    0.1450325 7.033284e-01\nfactor(abortion_policies)some restrictions/protections  5.1499418 2.324715e-02\nfactor(abortion_policies)protective                     6.8812601 8.710413e-03\nfactor(abortion_policies)very protective                6.5069583 1.074532e-02\nfactor(abortion_policies)most protective                4.3329275 3.738190e-02\n                                                       method\n(Intercept)                                                 2\nfactor(abortion_policies)very restrictive                   2\nfactor(abortion_policies)restrictive                        2\nfactor(abortion_policies)some restrictions/protections      2\nfactor(abortion_policies)protective                         2\nfactor(abortion_policies)very protective                    2\nfactor(abortion_policies)most protective                    2\n\nMethod: 1-Wald, 2-Profile penalized log-likelihood, 3-None\n\nLikelihood ratio test=13.27942 on 6 df, p=0.03880713, n=51\nWald test = 12.19211 on 6 df, p = 0.05781772\n\n\nCode\n# Generate predicted probabilities\ndf$predicted_prob &lt;- predict(fit, type = \"response\")\n\n# visualize\nggplot(df, aes(x = abortion_policies, y = predicted_prob)) +\n  geom_point(position = position_jitter(width = 0.2), alpha = 0.6) +\n  stat_summary(fun = mean, geom = \"point\", color = \"blue\", size = 3) +\n  labs(x = \"Abortion Policies\", \n       y = \"Predicted Probability\",\n       title = \"Parental Leave Job Protection \\nPredicted Probabilities by Abortion Policy\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\nDue to the sample sizes that were too small, we performed exact logistic regression to account for small sample sizes and separation. The exact logistic regression yielded a p-value of 0.03880713, indicating that there is significant evidence to suggest a linear relationship between job protection policy and the degree of restrictiveness to protectiveness of a state’s abortion policy.\nFrom the coefficients and the visualization, we can see that states with more protective abortion measures are more likely to have policy guaranteeing job protection for parents when they take paternal leave to care for their child(ren). This reveals that states that do not have abortion policy concurrently establish conditions that make having a child more difficult. This is problematic, because if the state creates conditions so that women are forced to have babies instead of being able to access abortion or contraceptive rights and then they have a baby, they face the jeopardy of losing their job and income with no protection.\n\n\nPercentage of Employed Women per State by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(percent_women_working ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  percent_women_working by abortion_policies\nKruskal-Wallis chi-squared = 13.889, df = 6, p-value = 0.0309\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$percent_women_working, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$percent_women_working and df$abortion_policies \n\n                              most restrictive very restrictive restrictive\nvery restrictive              1.00             -                -          \nrestrictive                   0.31             1.00             -          \nsome restrictions/protections 1.00             1.00             1.00       \nprotective                    0.13             1.00             1.00       \nvery protective               1.00             1.00             1.00       \nmost protective               1.00             1.00             1.00       \n                              some restrictions/protections protective\nvery restrictive              -                             -         \nrestrictive                   -                             -         \nsome restrictions/protections -                             -         \nprotective                    1.00                          -         \nvery protective               1.00                          1.00      \nmost protective               1.00                          1.00      \n                              very protective\nvery restrictive              -              \nrestrictive                   -              \nsome restrictions/protections -              \nprotective                    -              \nvery protective               -              \nmost protective               1.00           \n\nP value adjustment method: bonferroni \n\n\nCode\ndf$abortion_policies &lt;- factor(df$abortion_policies, \n                              levels = c(\"most protective\", \"very protective\", \n                                         \"protective\", \"some restrictions/protections\", \n                                         \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\nggplot(df, aes(x = abortion_policies, y = percent_women_working, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women Employed\",\n       title = \"Percentage of Women Employed by Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test yields a significant p-value of 0.0309, allowing us to suggest that there is truly a difference in the mean number of women working in at least one level of abortion policy. However, looking at the accompanying visualization, we cannot suggest that the percentage of employed women consistently increases with more protective abortion policies, because the range and mean of employed women percentages in states with “very protective” abortion policy appear to be quite low; the second lowest in the entire plot after states with the most restrictive policies. This is interesting, because only this group within levels of protective abortion policies stands out as having lower female employment rates.\n\n\nCode\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(\"clinfun\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'clinfun' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpGKi79t\\downloaded_packages\n\n\nCode\nlibrary(clinfun)\n\n\nWarning: package 'clinfun' was built under R version 4.4.2\n\n\nCode\njt_test &lt;- jonckheere.test(df$percent_women_working, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"decreasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 395.5, p-value = 0.0168\nalternative hypothesis: decreasing\n\n\n\n\nCode\n# Permutation test\nn_perm &lt;- 10000 \n\n# observed F-statistic\nobserved_anova &lt;- aov(percent_women_working ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\nset.seed(6547) \nperm_F &lt;- numeric(n_perm)\n\nfor (i in 1:n_perm) {\n  # permute the response variable\n  permuted_data &lt;- df\n  permuted_data$percent_women_working &lt;- sample(permuted_data$percent_women_working)\n  \n  # ANOVA on permuted data\n  perm_anova &lt;- aov(percent_women_working ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 2.588987 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0296 \n\n\nCode\n# visualization\nhist(perm_F, breaks = 30, main = \"Permutation Distribution of F-statistic\", xlab = \"F-statistic\")\nabline(v = observed_F, col = \"red\", lwd = 2, lty = 2)\n\n\n\n\n\n\n\n\n\nThe permutation test of the ANOVA test further confirms that this data has a significant p-value which indicates evidence to suggest that the mean percentage of employed women in at least one abortion policy group is different from the rest, but as noted above with the visualization, it does not necessarily mean that there is a “linear” relationship between more protective abortion policies and higher female employment.\n\n\nCode\ndf$abortion_policies &lt;- factor(df$abortion_policies, levels = c(\"most protective\", \"very protective\", \"protective\", \"some restrictions/protections\", \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\nggplot(df, aes(x = abortion_policies, y = percent_women_working, fill = abortion_policies)) + stat_summary(fun = mean, geom = \"bar\", position = \"dodge\") + theme_minimal() + scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) + theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1), plot.title = element_text(size = 10, hjust = 0.5)) + labs(x = \"Abortion Policies\", y = \"Mean % Women Working\", title = \"Mean Percentage of Women Working by Abortion Policy\")"
  },
  {
    "objectID": "results/maternal_wellness.html#education-wellness",
    "href": "results/maternal_wellness.html#education-wellness",
    "title": "Maternal Wellness - Statistical Modeling",
    "section": "Education Wellness",
    "text": "Education Wellness\n\nPercentage of Women per State with a BA degree or higher by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(percentage_women_BA_or_higher ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  percentage_women_BA_or_higher by abortion_policies\nKruskal-Wallis chi-squared = 19.526, df = 6, p-value = 0.003362\n\n\nCode\n# If Kruskal-Wallis is significant, run pairwise Wilcoxon tests\npairwise.wilcox.test(df$percentage_women_BA_or_higher, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$percentage_women_BA_or_higher and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.0000          -               -         \nprotective                    1.0000          1.0000          -         \nsome restrictions/protections 1.0000          1.0000          1.0000    \nrestrictive                   1.0000          1.0000          1.0000    \nvery restrictive              1.0000          1.0000          1.0000    \nmost restrictive              1.0000          0.5285          0.0128    \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.0000                        -          \nvery restrictive              1.0000                        1.0000     \nmost restrictive              1.0000                        0.0077     \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.0000          \n\nP value adjustment method: bonferroni \n\n\nCode\nggplot(df, aes(x = abortion_policies, y = percentage_women_BA_or_higher, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women with a Bachelors degree or higher\",\n       title = \"Percentage of Women with a Bachelors Degree or Higher by Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5)) \n\n\n\n\n\n\n\n\n\nThe p-value of 0.003362 indicates that we have significant evidence to reject the null hypothesis and suggest that there is a true different in the mean percentage of women with a college degree (BA) or higher in different states depending on their abortion policy. The boxplot visualization clearly indicates that states with more protective abortion policy have higher percentages of women with high education.\n\n\nCode\n# First, check sample sizes in each group\ntable(df$abortion_policies)\n\n\n\n              most protective               very protective \n                            2                             7 \n                   protective some restrictions/protections \n                           10                             5 \n                  restrictive              very restrictive \n                            7                             4 \n             most restrictive \n                           16 \n\n\nCode\n# Run Jonckheere-Terpstra test\njt_test &lt;- jonckheere.test(df$percentage_women_BA_or_higher, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"decreasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 263, p-value = 1e-04\nalternative hypothesis: decreasing\n\n\n\n\nCode\n# Permutation test\nn_perm &lt;- 10000 \n\n# observed F-statistic\nobserved_anova &lt;- aov(percentage_women_BA_or_higher ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\nset.seed(6547) \nperm_F &lt;- numeric(n_perm)\n\nfor (i in 1:n_perm) {\n  # permute the response variable\n  permuted_data &lt;- df\n  permuted_data$percentage_women_BA_or_higher &lt;- sample(permuted_data$percentage_women_BA_or_higher)\n  \n  # ANOVA on permuted data\n  perm_anova &lt;- aov(percentage_women_BA_or_higher ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 4.33953 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0019 \n\n\nCode\n# visualization\nhist(perm_F, breaks = 30, main = \"Permutation Distribution of F-statistic\", xlab = \"F-statistic\")\nabline(v = observed_F, col = \"red\", lwd = 2, lty = 2)\n\n\n\n\n\n\n\n\n\nA permutation test was performed on this data in addition to the Kruskal-Wallis test to ensure that the findings were consistent even with different tests. The p-value that the permutation test is also statistically significant at a value of 0.0019, indicating that we have evidence to suggest that the mean percentage of women who have obtained a Bachelor’s degree or higher varies in at least one level of abortion policy.\n\n\nCode\ndf$abortion_policies &lt;- factor(df$abortion_policies, levels = c(\"most protective\", \"very protective\", \"protective\", \"some restrictions/protections\", \"restrictive\", \"very restrictive\", \"most restrictive\"))\n\nggplot(df, aes(x = abortion_policies, y = percentage_women_BA_or_higher, fill = abortion_policies)) + stat_summary(fun = mean, geom = \"bar\", position = \"dodge\") + theme_minimal() + scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) + theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1), plot.title = element_text(size = 10, hjust = 0.5)) + labs(x = \"Abortion Policies\", y = \"Mean % Women with a BA or Higher\", title = \"Mean Percentage of Women with a BA or Higher by Abortion Policy\")\n\n\nWarning: Removed 1 row containing non-finite outside the scale range\n(`stat_summary()`)."
  },
  {
    "objectID": "results/maternal_wellness.html#mental-wellness",
    "href": "results/maternal_wellness.html#mental-wellness",
    "title": "Maternal Wellness - Statistical Modeling",
    "section": "Mental Wellness",
    "text": "Mental Wellness\n\nWomen with Postpartum Depression by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(percent_women_with_postpartum_depression_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  percent_women_with_postpartum_depression_2021 by abortion_policies\nKruskal-Wallis chi-squared = 5.3526, df = 6, p-value = 0.4995\n\n\nCode\npairwise.wilcox.test(df$percent_women_with_postpartum_depression_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$percent_women_with_postpartum_depression_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1               -               -         \nprotective                    1               1               -         \nsome restrictions/protections 1               1               1         \nrestrictive                   1               1               1         \nvery restrictive              1               1               1         \nmost restrictive              1               1               1         \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1                             -          \nvery restrictive              1                             1          \nmost restrictive              1                             1          \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1               \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying visualization\nggplot(df, aes(x = abortion_policies, y = percent_women_with_postpartum_depression_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women with Postpartum Depression\",\n       title = \"Percentage of Women with Postpartum Depression by Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test does not yield a statistically significant p-value therefore we do not have concrete evidence to suggest that there is a difference in the percentage of women with postpartum depression across the policy groups, but the accompanying visualization does offer provide insight that the highest occurrences of postpartum depression percentages are in states with most restrictive abortion policies.\n\n\nCode\nggplot(df, aes(x = abortion_policies, y = percent_women_with_postpartum_depression_2021, fill = abortion_policies)) + stat_summary(fun = mean, geom = \"bar\", position = \"dodge\") + theme_minimal() + scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) + theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1), plot.title = element_text(size = 10, hjust = 0.5)) + labs(x = \"Abortion Policies\", y = \"%\", title = \"Mean Percentage of Women With Postpartum Depression\")\n\n\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_summary()`).\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Calculate the overall average\noverall_avg &lt;- mean(df$percent_women_with_postpartum_depression_2021, na.rm = TRUE)\n\n# Filter and classify observations as Above or Below Average\ndf &lt;- df %&gt;%\n  filter(!is.na(abortion_policies) & !is.na(percent_women_with_postpartum_depression_2021)) %&gt;% \n  mutate(above_or_below = if_else(percent_women_with_postpartum_depression_2021 &gt; overall_avg, \n                                  \"Above Average\", \"Below Average\"))\n\n# Group and count observations\ndf_count &lt;- df %&gt;%\n  group_by(abortion_policies, above_or_below) %&gt;%\n  summarize(count = n(), .groups = \"drop\")\n\n# Convert counts to percentages\ndf_count &lt;- df_count %&gt;%\n  group_by(abortion_policies) %&gt;%\n  mutate(percentage = count / sum(count) * 100)\n\n# Create the stacked bar chart\nggplot(df_count, aes(x = abortion_policies, y = percentage, fill = above_or_below)) +\n  geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.7) +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"Above Average\" = \"#1c7416\", \"Below Average\" = \"#ff0000\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"Percentage of Observations\",\n       fill = \"Comparison to Average\",\n       title = \"Percentage of Above/Below Average Postpartum Depression by Abortion Policy\") +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        plot.title = element_text(size = 10, hjust = 0.5),\n        axis.title.y = element_text(size = 10))\n\n\n\n\n\n\n\n\n\n\n\nWomen with Depression Before or During Pregnancy by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(women_with_depression_before_or_during_pregnancy_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  women_with_depression_before_or_during_pregnancy_2021 by abortion_policies\nKruskal-Wallis chi-squared = 10.354, df = 6, p-value = 0.1105\n\n\nCode\npairwise.wilcox.test(df$women_with_depression_before_or_during_pregnancy_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$women_with_depression_before_or_during_pregnancy_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              1.00            0.68            1.00      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying visualization\nggplot(df, aes(x = abortion_policies, y = women_with_depression_before_or_during_pregnancy_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women with Depression Before or During Pregnancy\",\n       title = \"Percentage of Women with Depression Before or During Pregnancy by Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal Wallis test does not provide any evidence to suggest that there is an association between depression before or during pregnancy among women and the abortion policy strictness in their state.\n\n\nCode\nggplot(df, aes(x = abortion_policies, y = women_with_depression_before_or_during_pregnancy_2021, fill = abortion_policies)) + stat_summary(fun = mean, geom = \"bar\", position = \"dodge\") + theme_minimal() + scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) + theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1), plot.title = element_text(size = 10, hjust = 0.5)) + labs(x = \"Abortion Policies\", y = \"%\", title = \"Mean Percentage of Women With Depression Before or During Pregnancy by Abortion Policy\")\n\n\n\n\n\n\n\n\n\n\n\nPercentage of Women Who Received a Postpartum Depression Screening in 2021, by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(percent_women_who_received_a_postpartum_depression_screening_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  percent_women_who_received_a_postpartum_depression_screening_2021 by abortion_policies\nKruskal-Wallis chi-squared = 15.405, df = 6, p-value = 0.01733\n\n\nCode\npairwise.wilcox.test(df$percent_women_who_received_a_postpartum_depression_screening_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$percent_women_who_received_a_postpartum_depression_screening_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.000           -               -         \nprotective                    1.000           1.000           -         \nsome restrictions/protections 1.000           1.000           1.000     \nrestrictive                   1.000           1.000           1.000     \nvery restrictive              1.000           1.000           1.000     \nmost restrictive              1.000           1.000           0.088     \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.000                         -          \nvery restrictive              1.000                         1.000      \nmost restrictive              1.000                         0.345      \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.000           \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying visualization\nggplot(df, aes(x = abortion_policies, y = percent_women_who_received_a_postpartum_depression_screening_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women Receiving Postpartum Depression Screening\",\n       title = \"Percentage of Women who Received Postpartum Depression Screening by Abortion Policy\") +\n  theme(plot.title = element_text(size = 8, hjust = 0.5))\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Run Jonckheere-Terpstra test\njt_test &lt;- jonckheere.test(df$percent_women_who_received_a_postpartum_depression_screening_2021, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"decreasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 105, p-value = 3e-04\nalternative hypothesis: decreasing\n\n\n\n\nCode\n# Permutation test\nn_perm &lt;- 10000 \n\n# observed F-statistic\nobserved_anova &lt;- aov(percent_women_who_received_a_postpartum_depression_screening_2021 ~ abortion_policies, data = df)\nobserved_F &lt;- summary(observed_anova)[[1]][[\"F value\"]][1]\n\nset.seed(6547) \nperm_F &lt;- numeric(n_perm)\n\nfor (i in 1:n_perm) {\n  # Permute the response variable\n  permuted_data &lt;- df\n  permuted_data$percent_women_who_received_a_postpartum_depression_screening_2021 &lt;- sample(permuted_data$percent_women_who_received_a_postpartum_depression_screening_2021)\n  \n  # Perform ANOVA on permuted data\n  perm_anova &lt;- aov(percent_women_who_received_a_postpartum_depression_screening_2021 ~ abortion_policies, data = permuted_data)\n  perm_F[i] &lt;- summary(perm_anova)[[1]][[\"F value\"]][1]\n}\n\n# Calculate p-value\np_value &lt;- mean(perm_F &gt;= observed_F)\n\n# Print results\ncat(\"Observed F-statistic:\", observed_F, \"\\n\")\n\n\nObserved F-statistic: 4.212749 \n\n\nCode\ncat(\"Permutation Test p-value:\", p_value, \"\\n\")\n\n\nPermutation Test p-value: 0.0091 \n\n\nCode\n# Visualize the permutation distribution\nhist(perm_F, breaks = 30, main = \"Permutation Distribution of F-statistic\", xlab = \"F-statistic\")\nabline(v = observed_F, col = \"red\", lwd = 2, lty = 2)\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis test indicates that we have significant evidence at a p-value of 0.01733 that there is an association between the percentage of women screened for postpartum depression in a state and the state’s abortion policy. The boxplot visualization reveals that postpartum depression screening is the highest in states with the most protective abortion policies, where approximately 94% of women are screened. The lowest percentage of women screened for postpartum depression is in the states that are the most restrictive. This suggests that states that prioritize screening for mothers’ mental health are also the most considerate of abortion rights, whereas states that chose to implement more restrictive abortion policies already do not prioritize widespread screening for mothers’ postpartum depression.\n\n\nCode\nggplot(df, aes(x = abortion_policies, y = percent_women_who_received_a_postpartum_depression_screening_2021, fill = abortion_policies)) + stat_summary(fun = mean, geom = \"bar\", position = \"dodge\") + theme_minimal() + scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) + theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1), plot.title = element_text(size = 10, hjust = 0.5)) + labs(x = \"Abortion Policies\", y = \"%\", title = \"Mean Percentage of Women Recieved Postpartum Depression Screening\")\n\n\n\n\n\n\n\n\n\n\n\nPercentage of Women Experiencing Intimate Partner Violence by Abortion Policy\n\n\nCode\n# Kruskal-Wallis test\nkruskal.test(percent_women_experiencing_intimate_partner_violence_2021 ~ abortion_policies, data = df)\n\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  percent_women_experiencing_intimate_partner_violence_2021 by abortion_policies\nKruskal-Wallis chi-squared = 10.88, df = 6, p-value = 0.09215\n\n\nCode\npairwise.wilcox.test(df$percent_women_experiencing_intimate_partner_violence_2021, \n                     df$abortion_policies,\n                     p.adjust.method = \"bonferroni\")\n\n\n\n    Pairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$percent_women_experiencing_intimate_partner_violence_2021 and df$abortion_policies \n\n                              most protective very protective protective\nvery protective               1.00            -               -         \nprotective                    1.00            1.00            -         \nsome restrictions/protections 1.00            1.00            1.00      \nrestrictive                   1.00            1.00            1.00      \nvery restrictive              1.00            1.00            1.00      \nmost restrictive              1.00            0.58            0.84      \n                              some restrictions/protections restrictive\nvery protective               -                             -          \nprotective                    -                             -          \nsome restrictions/protections -                             -          \nrestrictive                   1.00                          -          \nvery restrictive              1.00                          1.00       \nmost restrictive              1.00                          1.00       \n                              very restrictive\nvery protective               -               \nprotective                    -               \nsome restrictions/protections -               \nrestrictive                   -               \nvery restrictive              -               \nmost restrictive              1.00            \n\nP value adjustment method: bonferroni \n\n\nCode\n# accompanying visualization\nggplot(df, aes(x = abortion_policies, y = percent_women_experiencing_intimate_partner_violence_2021, fill=abortion_policies)) +\n  geom_boxplot() +\n  theme_minimal() +\n  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n        axis.title.y = element_text(size = 10)) + \n  scale_fill_manual(values = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\")) +\n  labs(x = \"Abortion Policies\", \n       y = \"% Women Experiencing Domestic Violence\",\n       title = \"Percentage of Women Experiencing Intimate Partner Violence by Abortion Policy\") +\n  theme(plot.title = element_text(size = 10, hjust = 0.5))\n\n\n\n\n\n\n\n\n\nThe Kruskal-Wallis Test and the boxplot visualization to not provide any evidence to suggest that there is a relationship between the prevalence of women experiencing domestic violence and the state’s abortion policy.\n\n\nCode\n# Run Jonckheere-Terpstra test\njt_test &lt;- jonckheere.test(df$percent_women_experiencing_intimate_partner_violence_2021, \n                          as.numeric(df$abortion_policies), \n                          alternative=\"increasing\",\n                          nperm = 10000)\nprint(jt_test)\n\n\n\n    Jonckheere-Terpstra test\n\ndata:  \nJT = 298.5, p-value = 0.0077\nalternative hypothesis: increasing"
  },
  {
    "objectID": "results/maternal_wellness.html#travel",
    "href": "results/maternal_wellness.html#travel",
    "title": "Maternal Wellness - Statistical Modeling",
    "section": "Travel",
    "text": "Travel\n\n\nCode\ninstall.packages(\"usmap\")\n\n\nInstalling package into 'C:/Users/court/AppData/Local/R/win-library/4.4'\n(as 'lib' is unspecified)\n\n\npackage 'usmap' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\court\\AppData\\Local\\Temp\\RtmpGKi79t\\downloaded_packages\n\n\nCode\nlibrary(usmap)\n\n\nWarning: package 'usmap' was built under R version 4.4.2\n\n\nCode\nlibrary()\nabortion_map_data &lt;- df %&gt;%\n  select(State, `percent_increase_in_clinician_provided_abortions_since_2020`) %&gt;%\n  filter(!is.na(`percent_increase_in_clinician_provided_abortions_since_2020`)) %&gt;%\n  mutate(\n    state = State,\n    change = `percent_increase_in_clinician_provided_abortions_since_2020`\n  ) \n\nprint(\"First few rows of our data:\")\n\n\n[1] \"First few rows of our data:\"\n\n\nCode\nhead(abortion_map_data)\n\n\n# A tibble: 6 × 4\n  State                percent_increase_in_clinician_provided_abo…¹ state change\n  &lt;chr&gt;                                                       &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;\n1 Colorado                                                     96.1 Colo…   96.1\n2 Delaware                                                     92.2 Dela…   92.2\n3 District of Columbia                                          2.7 Dist…    2.7\n4 Georgia                                                      24.3 Geor…   24.3\n5 Hawaii                                                       27.3 Hawa…   27.3\n6 Illinois                                                     71.6 Illi…   71.6\n# ℹ abbreviated name:\n#   ¹​percent_increase_in_clinician_provided_abortions_since_2020\n\n\nCode\nplot_usmap(data = abortion_map_data, values = \"change\") +\n  scale_fill_gradient2(\n    name = \"% Change\",\n    low = \"#ff6b6b\",   \n    mid = \"#ffffff\",    \n    high = \"#4dbd00\",  \n    midpoint = 0,\n    na.value = \"gray80\"  \n  ) +\n  theme(\n    legend.position = \"right\",\n    plot.title = element_text(size = 14, hjust = 0.5)\n  ) +\n  labs(title = \"Change in Clinician-Provided Abortions Since 2020 by State\")\n\n\n\n\n\n\n\n\n\n\n\nCode\ninstall.packages(c(\"usmap\", \"ggplot2\"))\n\n\nWarning: packages 'usmap', 'ggplot2' are in use and will not be installed\n\n\nCode\nlibrary(usmap)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(sf)\n\n\nWarning: package 'sf' was built under R version 4.4.2\n\n\nLinking to GEOS 3.12.2, GDAL 3.9.3, PROJ 9.4.1; sf_use_s2() is TRUE\n\n\nCode\n# Create data frame with state capitals for the specified states\ncapitals_df &lt;- data.frame(\n  lon = c(-116.200, -100.346, -93.603, -92.189, -92.289,\n          -91.187, -97.743, -97.503, -90.182, -86.279,\n          -84.280, -86.781, -84.878, -86.162, -81.633),\n  lat = c(43.617, 44.367, 41.591, 38.579, 34.746,\n          30.457, 30.266, 35.482, 32.298, 32.377,\n          30.438, 36.162, 38.186, 39.768, 38.336),\n  state = c(\"Idaho\", \"South Dakota\", \"Iowa\", \"Missouri\", \"Arkansas\",\n            \"Louisiana\", \"Texas\", \"Oklahoma\", \"Mississippi\", \"Alabama\",\n            \"Florida\", \"Tennessee\", \"Kentucky\", \"Indiana\", \"West Virginia\")\n)\n\n\n# Plot the map with stars for capitals\nplot_usmap(data = abortion_map_data, values = \"percent_increase_in_clinician_provided_abortions_since_2020\") +\n  geom_point(data = capitals_df, \n             aes(x = lon, y = lat), # Use longitude and latitude for capitals\n             shape = 8,         # Star shape\n             size = 4,          # Adjust size\n             color = \"black\",   # Star color\n             stroke = 1.5) +    # Thickness of the outline\n  scale_fill_gradient2(\n    name = \"% Change\",\n    low = \"#ff6b6b\",   \n    mid = \"#ffffff\",    \n    high = \"#4dbd00\",  \n    midpoint = 0,\n    na.value = \"gray80\"  \n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    plot.title = element_text(size = 14, hjust = 0.5)\n  ) +\n  labs(title = \"Change in Clinician-Provided Abortions Since 2020 by State\",\n       caption = \"*Stars indicate state capitals*\")"
  },
  {
    "objectID": "results/travel.html",
    "href": "results/travel.html",
    "title": "Travel Data EDA",
    "section": "",
    "text": "library(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.4.2\n\n\nWarning: package 'ggplot2' was built under R version 4.4.2\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(ggplot2)\nlibrary(maps)\n\nWarning: package 'maps' was built under R version 4.4.2\n\n\n\nAttaching package: 'maps'\n\nThe following object is masked from 'package:purrr':\n\n    map\n\nlibrary(networkD3)\n\nWarning: package 'networkD3' was built under R version 4.4.2\n\nlibrary(ggalluvial)\n\nWarning: package 'ggalluvial' was built under R version 4.4.2\n\nlibrary(htmltools)\n\n\npolicy_travel &lt;- read.csv(\"../data/clean_data/policy_travel_jlin.csv\")\npolicy_travel$X &lt;- NULL\n\nunique(policy_travel$abortion_policies)\n\n[1] \"most restrictive\"              \"protective\"                   \n[3] \"very restrictive\"              \"very protective\"              \n[5] \"some restrictions/protections\" \"restrictive\"                  \n[7] \"most protective\"              \n\n\n\n# Create policy_distribution by grouping and counting states by abortion_policies\npolicy_distribution &lt;- policy_travel %&gt;%\n  group_by(abortion_policies) %&gt;%\n  summarise(State_Count = n()) %&gt;%\n  ungroup()\n\n# Plot the bar chart with labels next to the bars\nggplot(policy_distribution, aes(x = abortion_policies, y = State_Count, fill = abortion_policies)) +\n    geom_bar(stat = \"identity\", color = \"black\", width = 0.7) +\n    geom_text(\n        aes(label = State_Count), # Add state count as labels\n        hjust = 1.1, # Adjust placement inside or near the end of the bar\n        size = 6, # Adjust label size\n        color = \"black\" # Ensure visibility of text on colored bars\n    ) +\n    scale_fill_manual(\n        values = c(\n            \"most protective\" = \"#1c7416\",\n            \"very protective\" = \"#68bb59\",\n            \"protective\" = \"#acdf87\",\n            \"some restrictions/protections\" = \"#fab733\",\n            \"restrictive\" = \"#ff6242\",\n            \"very restrictive\" = \"#ff0000\",\n            \"most restrictive\" = \"#c61a09\"\n        )\n    ) +\n    labs(\n        title = \"Abortion Policies Across U.S. States (2023)\",\n        subtitle = \"States categorized by level of policy restrictiveness\",\n        x = NULL, # Remove x-axis label\n        y = NULL, # Remove y-axis label\n        fill = \"Policy Level\"\n    ) +\n    theme_minimal() +\n    theme(\n        plot.title = element_text(size = 20, hjust = 0.5), # Bigger and bold title\n        plot.subtitle = element_text(size = 16, hjust = 0.5), # Bigger subtitle\n        axis.title.x = element_blank(), # Remove x-axis title\n        axis.text.x = element_blank(), # Remove x-axis text\n        axis.ticks.x = element_blank(), # Remove x-axis ticks\n        axis.title.y = element_text(size = 16), # Keep y-axis title for clarity\n        axis.text.y = element_text(size = 14), # Bigger y-axis text\n        legend.title = element_text(size = 14), # Bigger legend title\n        legend.text = element_text(size = 12), # Bigger legend text\n        panel.grid.major.x = element_blank(), # Remove vertical grid lines\n        panel.grid.minor.x = element_blank() # Remove minor grid lines\n    ) +\n    coord_flip() # Flip the coordinates for better readability\n\n\n\n\n\n\n\n\n\n# Standardize the state names (convert to lowercase for matching)\npolicy_travel &lt;- policy_travel %&gt;%\n    mutate(State = tolower(State))\n\npolicy_travel &lt;- policy_travel %&gt;%\n    mutate(State = tolower(State))\n\n# Create a numerical mapping for all the policy levels\npolicy_levels &lt;- c(\n    \"most protective\",\n    \"very protective\",\n    \"protective\",\n    \"some restrictions/protections\",\n    \"restrictive\",\n    \"very restrictive\",\n    \"most restrictive\"\n)\n\n# Map policy levels to a numeric scale\npolicy_travel &lt;- policy_travel %&gt;%\n    mutate(policy_score = factor(abortion_policies, levels = policy_levels, labels = 1:length(policy_levels))) %&gt;%\n    mutate(policy_score = as.numeric(as.character(policy_score)))\n\n# Load map data for the United States\nstates_map &lt;- map_data(\"state\")\n\n# Merge the dataset with the map data\nmap_data &lt;- states_map %&gt;%\n    left_join(policy_travel, by = c(\"region\" = \"State\"))\n\nggplot(map_data, aes(long, lat, group = group, fill = policy_score)) +\n    geom_polygon(color = \"black\", size = 0.3) +\n    coord_fixed(1.3) +\n    theme_minimal() +\n    scale_fill_gradientn(\n        colors = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\"),\n        breaks = c(1, 4, 7), # Fewer labels: First, Middle, and Last\n        labels = c(\"Most (+)\", \"Some (+/-)\", \"Most (-)\"), # Simplified labels\n        na.value = \"gray80\",\n        guide = guide_colorbar(\n            barwidth = 15,\n            barheight = 1,\n            title.position = \"top\",\n            title.hjust = 0.5 # Center the title\n        )\n    ) +\n    labs(\n        title = \"Abortion Policies by State (USA) 2023\",\n        subtitle = \"States categorized by level of restrictiveness\",\n        fill = \"Policy Restrictiveness\"\n    ) +\n    theme(\n        plot.title = element_text(size = 18, hjust = 0.5),\n        plot.subtitle = element_text(size = 12, hjust = 0.5),\n        legend.title = element_text(size = 12, hjust = 0.5),\n        legend.text = element_text(size = 10, angle = 45, vjust = 1, hjust = 1), # Rotate labels to reduce clutter\n        legend.position = \"bottom\",\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank()\n    )\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\n\n\n# Standardize the state names for compatibility with map data\npolicy_travel &lt;- policy_travel %&gt;%\n    mutate(State = tolower(State))\n\n# Calculate total inbound travel for each state\npolicy_travel &lt;- policy_travel %&gt;%\n    rowwise() %&gt;%\n    mutate(total_inbound = sum(across(ends_with(\"_residence_travelled_to_for_abortion\")), na.rm = TRUE)) %&gt;%\n    ungroup()\n\n# Load U.S. states map data\nstates_map &lt;- map_data(\"state\")\n\n# Merge map data with the travel data\nmap_data &lt;- states_map %&gt;%\n    left_join(policy_travel, by = c(\"region\" = \"State\"))\n\n# Plot the choropleth map\nggplot(map_data, aes(long, lat, group = group, fill = total_inbound)) +\n    geom_polygon(color = \"black\", size = 0.2) +\n    coord_fixed(1.3) +\n    scale_fill_gradientn(\n        colors = c(\"#1c7416\", \"#68bb59\", \"#acdf87\", \"#fab733\", \"#ff6242\", \"#ff0000\", \"#c61a09\"),\n        na.value = \"gray80\",\n        name = \"Inbound Travel\"\n    ) +\n    labs(\n        title = \"Inbound Abortion Travel by State (2023)\",\n        subtitle = \"Number of individuals traveling to each state for abortion services\"\n    ) +\n    theme_minimal() +\n    theme(\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5), # Smaller size and centered\n        plot.subtitle = element_text(size = 12, hjust = 0.5),\n        legend.position = \"right\",\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank()\n    )\n\n\n\n\n\n\n\n\n\n# Step 1: Extract travel data columns\n# Select relevant columns: State and destinations for abortion travel\n# Create a lookup table for state abbreviations and full names\nstate_abbreviations &lt;- tibble(\n    abbr = c(\n        \"AL\", \"AK\", \"AZ\", \"AR\", \"CA\", \"CO\", \"CT\", \"DE\", \"FL\", \"GA\", \"HI\", \"ID\", \"IL\", \"IN\", \"IA\", \"KS\",\n        \"KY\", \"LA\", \"ME\", \"MD\", \"MA\", \"MI\", \"MN\", \"MS\", \"MO\", \"MT\", \"NE\", \"NV\", \"NH\", \"NJ\", \"NM\", \"NY\",\n        \"NC\", \"ND\", \"OH\", \"OK\", \"OR\", \"PA\", \"RI\", \"SC\", \"SD\", \"TN\", \"TX\", \"UT\", \"VT\", \"VA\", \"WA\", \"WV\", \"WI\", \"WY\"\n    ),\n    full = c(\n        \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"California\", \"Colorado\", \"Connecticut\", \"Delaware\", \"Florida\",\n        \"Georgia\", \"Hawaii\", \"Idaho\", \"Illinois\", \"Indiana\", \"Iowa\", \"Kansas\", \"Kentucky\", \"Louisiana\", \"Maine\",\n        \"Maryland\", \"Massachusetts\", \"Michigan\", \"Minnesota\", \"Mississippi\", \"Missouri\", \"Montana\", \"Nebraska\",\n        \"Nevada\", \"New Hampshire\", \"New Jersey\", \"New Mexico\", \"New York\", \"North Carolina\", \"North Dakota\",\n        \"Ohio\", \"Oklahoma\", \"Oregon\", \"Pennsylvania\", \"Rhode Island\", \"South Carolina\", \"South Dakota\",\n        \"Tennessee\", \"Texas\", \"Utah\", \"Vermont\", \"Virginia\", \"Washington\", \"West Virginia\", \"Wisconsin\", \"Wyoming\"\n    )\n)\n\n# Extract and rename travel data columns, replacing &lt;State ID&gt; with full names\ntravel_data &lt;- policy_travel %&gt;%\n    select(State, ends_with(\"_residence_travelled_to_for_abortion\")) %&gt;%\n    rename_with(\n        ~ sub(\"_residence_travelled_to_for_abortion\", \"\", .), # Remove the suffix\n        ends_with(\"_residence_travelled_to_for_abortion\")\n    ) %&gt;%\n    rename_with(\n        ~ ifelse(\n            !is.na(state_abbreviations$full[match(., state_abbreviations$abbr)]), # Check if a match is found\n            state_abbreviations$full[match(., state_abbreviations$abbr)], # Replace with full name\n            . # Otherwise, retain the original abbreviation\n        ),\n        everything()\n    )\n\n# Step 2: Reshape data for Sankey plot\n# Convert wide format to long format and flip Source and Target\nflow_data &lt;- travel_data %&gt;%\n    pivot_longer(-State, names_to = \"Source\", values_to = \"Flow\") %&gt;% # Treat \"State\" as Target initially\n    filter(Flow &gt; 0) %&gt;% # Remove zero flows\n    rename(Target = State) # Flip Source and Target\n\n# Step 3: Exclude in-state travel\n# Remove rows where the Source and Target are the same\nflow_data &lt;- flow_data %&gt;%\n    filter(Source != Target)\n\n# Step 4: Prepare nodes list\n# Ensure all unique states (sources and targets) are represented as nodes\nunique_states &lt;- unique(c(flow_data$Source, flow_data$Target))\nnodes &lt;- data.frame(name = unique_states)\n\n# Step 5: Map nodes to indices\n# Add numeric indices for Source and Target nodes\nflow_data &lt;- flow_data %&gt;%\n    mutate(\n        SourceID = match(Source, nodes$name) - 1, # Convert to zero-based index\n        TargetID = match(Target, nodes$name) - 1\n    )\n\n# Step 6: Generate the flipped Sankey plot\n# Create an interactive Sankey diagram using sankeyNetwork\nsankey_plot &lt;- sankeyNetwork(\n    Links = flow_data,\n    Nodes = nodes,\n    Source = \"SourceID\",\n    Target = \"TargetID\",\n    Value = \"Flow\",\n    NodeID = \"name\",\n    units = \"People\", # Indicate units of measure\n    fontSize = 12, # Adjust font size\n    nodeWidth = 10, # Set node width\n    nodePadding = 10, # Add padding between nodes\n    height = 1200, # Adjust plot height\n    width = 1200 # Adjust plot width\n)\n\nLinks is a tbl_df. Converting to a plain data frame.\n\n# Display the Sankey plot\n# sankey_plot\n\n# Title for the plot\ntitle &lt;- tags$h2(\"Visualization of Abortion Travel Flows Across States (2023)\",\n    style = \"text-align: center; font-family: Arial; margin-bottom: 20px; font-size:17px;\"\n)\n\nleft_header &lt;- tags$h3(\n    \"Home State\",\n    style = \"position: absolute; top: -15px; left: 50px; font-family: Arial; font-size:15px; text-align: center;\"\n)\n\nright_header &lt;- tags$h3(\n    \"Destination State\",\n    style = \"position: absolute; top: -15px; right: 50px; font-family: Arial; font-size:15px; text-align: center;\"\n)\n\n# Combine the title, headers, and Sankey plot\nhtml_output &lt;- tagList(\n    title,\n    div(style = \"position: relative;\", left_header, right_header, sankey_plot)\n)\n\n# Display the output\nhtml_output\n\nVisualization of Abortion Travel Flows Across States (2023)\n\nHome State\nDestination State"
  }
]